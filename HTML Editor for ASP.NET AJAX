
HTML Editor for ASP.NET AJAX
Basic Edition

Copyright (c) Winthusiasm, Eric Williams
EMail: mail@winthusiasm.com, eric@winthusiasm.com

This software is free: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as 
published by the Free Software Foundation, either version 3 of
the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU Lesser General Public License for more details.

A copy of the GNU Lesser General Public License should accompany
this software. If not, see <http://www.gnu.org/licenses/>.
*/

using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Configuration;
using System.Data;
using System.Diagnostics;
using System.Diagnostics.CodeAnalysis;
using System.Drawing;
using System.Text.RegularExpressions;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;

[assembly: WebResource("Winthusiasm.HtmlEditor.Images.backcolor.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.bold.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.bulletedlist.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.center.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.forecolor.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.image.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.indent.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.italic.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.justify.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.left.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.link.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.orderedlist.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.outdent.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.pixel.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.right.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.subscript.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.superscript.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.rule.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.underline.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.design.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.html.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.view.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.save.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.new.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.separator.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.Toolstrips.Default.Begin.bmp", "img/bmp")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.Toolstrips.Default.Body.bmp", "img/bmp")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.Toolstrips.Default.End.bmp", "img/bmp")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.Toolstrips.Default.separator.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.Toolstrips.VisualStudio.Begin.bmp", "img/bmp")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.Toolstrips.VisualStudio.Body.bmp", "img/bmp")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.Toolstrips.VisualStudio.End.bmp", "img/bmp")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Images.Toolstrips.VisualStudio.separator.gif", "img/gif")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Scripts.HtmlEditor.js", "text/javascript")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Scripts.DialogBehavior.js", "text/javascript")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Dialogs.Blank.htm", "text/html")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Dialogs.Link.htm", "text/html")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Dialogs.Image.htm", "text/html")]
[assembly: WebResource("Winthusiasm.HtmlEditor.Dialogs.Color.htm", "text/html")]
[assembly: CLSCompliant(true)]

namespace Winthusiasm.HtmlEditor
{
    /// <summary>
    /// Class for HTML editor
    /// </summary>
    [ValidationProperty("Text")]
    public class HtmlEditor : CompositeControl, IScriptControl
    {       
        /// <summary>
        /// field for default border 
        /// </summary>
        protected const int DefaultEditorBorderSize = 3;
        
        /// <summary>
        /// field for default tool strip
        /// </summary>
        protected const string DefaultToolstripBackgroundImageCustomPath = "";

        /// <summary>
        /// field for default allowed tags
        /// </summary>
        protected const string DefaultAllowedTags = "p,b,i,u,em,big,small,div,img,span,blockquote,code,pre,br,hr,ul,ol,li,del,ins,strong,a,font,dl,dd,dt,h1,h2,h3,h4,h5,h6,address,sub,sup";

        /// <summary>
        /// field for default allowed attributes
        /// </summary>
        protected const string DefaultAllowedAttributes = "class,href,target,src,align,valign,color,size,style,face,dir,alt,title";

        /// <summary>
        /// field for default no script attributes
        /// </summary>
        protected const string DefaultNoScriptAttributes = "href,src";

        /// <summary>
        /// field for default toolbar class
        /// </summary>
        protected const string DefaultToolbarClass = "";
        
        /// <summary>
        /// field for default toolbar
        /// </summary>
        protected const string DefaultToolbars = "Select#Format,Select#Font,Select#Size:ForeColor,BackColor;Bold,Italic,Underline:Left,Center,Right,Justify|OrderedList,BulletedList|Indent,Outdent|Rule|Subscript,Superscript:Link,Image";

        /// <summary>
        /// Gets or sets default Auto Save Validation Groups
        /// </summary>
        protected const string DefaultAutoSaveValidationGroups = "*";

        /// <summary>
        /// The CreateColorSchemeInfoEventKey field
        /// </summary>        
        private static readonly object CreateColorSchemeInfoEventKey = new object();

        /// <summary>
        /// The Create Dialog Info Event Key field
        /// </summary>        
        private static readonly object CreateDialogInfoEventKey = new object();

        /// <summary>
        /// The SaveEventKey field
        /// </summary>        
        private static readonly object SaveEventKey = new object();        

        /// <summary>
        /// The Create Tool bar Info Event Key field
        /// </summary>        
        private static readonly object CreateToolbarInfoEventKey = new object();

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="htmlText">HTML Text</param> 
        private string htmlText = string.Empty;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="htmlencodedText">HTML encoded Text</param> 
        private HiddenField htmlencodedText;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="modifiedFlag">Modified Flag</param> 
        private HiddenField modifiedFlag;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="htmlEditor">HTML Editor</param> 
        private HtmlGenericControl htmlEditor;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="designEditor">Design Editor</param> 
        private HtmlGenericControl designEditor;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="htmlArea">HTML Area</param> 
        private HtmlGenericControl htmlArea;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="designArea">design Area</param> 
        private HtmlGenericControl designArea;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="toolbarContainer">toolbar Container</param> 
        private HtmlGenericControl toolbarContainer;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="htmlTab">html Tab</param> 
        private HtmlGenericControl htmlTab;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="designTab">design Tab</param> 
        private HtmlGenericControl designTab;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="saveButton">save Button</param> 
        private Button saveButton;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="updatePanel">update Panel</param> 
        private UpdatePanel updatePanel;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="dialogData">dialog Data</param> 
        private string dialogData;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="toolbarData">toolbar Data</param> 
        private string toolbarData;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="dialogBoxIDs">dialogBox IDs</param> 
        private string dialogBoxIDs;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="toolbarIDs">toolbar IDs</param> 
        private string toolbarIDs;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="validators">validators</param> 
        private List<CustomValidator> validators;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="updateHtml">update Html</param> 
        private bool updateHtml = false;

        /// <summary>
        /// parameters for HTML editor
        /// </summary>
        /// <param name="sm">Script Manager</param> 
        private ScriptManager sm;

        /// <summary>
        /// Gets or sets editor Width
        /// </summary>
        private int editorWidth = 0;

        /// <summary>
        /// Gets or sets editor Height
        /// </summary>
        private int editorHeight = 0;

        /// <summary>
        /// Gets or sets tool bar Height
        /// </summary>
        private int toolbarHeight = 25;

        /// <summary>
        /// Gets or sets tab bar Height
        /// </summary>
        private int tabbarHeight = 30;

        /// <summary>
        /// Gets or sets tab Height
        /// </summary>
        private int tabHeight = 24;

        /// <summary>
        /// field for tab width
        /// </summary>
        private int tabWidth = 80;

        /// <summary>
        /// field for tab width
        /// </summary>
        private int dialogHeadingHeight = 30;

        /// <summary>
        /// field for tab width
        /// </summary>
        private int dialogButtonBarHeight = 30;

        /// <summary>
        /// The SaveEventHandler delegate
        /// </summary>        
        /// <param name="sender">The sender parameter</param>
        /// <param name="e">The parameter e</param>
        public delegate void SaveEventHandler(object sender, SaveEventArgs e);

        /// <summary>
        /// The Create Tool bar Info Event Handler delegate
        /// </summary>
        /// <param name="sender">The parameter sender</param>
        /// <param name="e">The parameter e</param>
        public delegate void CreateToolbarInfoEventHandler(object sender, CreateToolbarInfoEventArgs e);

        /// <summary>
        /// The Create Dialog Info Event Handler delegate
        /// </summary>    
        /// <param name="sender">The parameter sender</param>
        /// <param name="e">The parameter e</param>
        public delegate void CreateDialogInfoEventHandler(object sender, CreateDialogInfoEventArgs e);

        /// <summary>
        /// The CreateColorSchemeInfoEventHandler delegate
        /// </summary>   
        /// <param name="sender">Parameter sender</param>
        /// <param name="e">The editor e</param>
        public delegate void CreateColorSchemeInfoEventHandler(object sender, CreateColorSchemeInfoEventArgs e);

        /// <summary>
        /// The CreateColorSchemeInfo event
        /// </summary>        
        [Category("Appearance")]
        [Description("Event handler called when the color scheme is created.")]
        public event CreateColorSchemeInfoEventHandler CreateColorSchemeInfo
        {
            add
            {
                Events.AddHandler(CreateColorSchemeInfoEventKey, value);
            }

            remove
            {
                Events.RemoveHandler(CreateColorSchemeInfoEventKey, value);
            }
        }

        /// <summary>
        /// The CreateToolbarInfo event
        /// </summary>        
        [Category("Behavior")]
        [Description("Event handler called when toolbars are created.")]
        public event CreateToolbarInfoEventHandler CreateToolbarInfo
        {
            add
            {
                Events.AddHandler(CreateToolbarInfoEventKey, value);
            }

            remove
            {
                Events.RemoveHandler(CreateToolbarInfoEventKey, value);
            }
        }

        /// <summary>
        /// The Create Dialog Info event
        /// </summary>        
        [Category("Behavior")]
        [Description("Event handler called when dialogs are created.")]
        public event CreateDialogInfoEventHandler CreateDialogInfo
        {
            add
            {
                Events.AddHandler(CreateDialogInfoEventKey, value);
            }

            remove
            {
                Events.RemoveHandler(CreateDialogInfoEventKey, value);
            }
        }

        /// <summary>
        /// The Save event
        /// </summary>        
        [Category("Behavior")]
        [Description("Event handler called when the Save toolbar button is clicked.")]
        public event SaveEventHandler Save
        {
            add
            {
                Events.AddHandler(SaveEventKey, value);
            }

            remove
            {
                Events.RemoveHandler(SaveEventKey, value);
            }
        }

        /// <summary>
        /// Enum  mode
        /// </summary>
        public enum Mode
        {
            /// <summary>
            /// Enum Design
            /// </summary>
            Design,

            /// <summary>
            /// Enum Html
            /// </summary>
            Html
        }

        /// <summary>
        /// Enum  mode
        /// </summary>
        public enum Direction
        {
            /// <summary>
            /// Enum    NotSet
            /// </summary>
            NotSet,

            /// <summary>
            /// Enum  LeftToRight
            /// </summary>
            LeftToRight,

            /// <summary>
            /// Enum    RightToLeft
            /// </summary>
            RightToLeft
        }

        /// <summary>
        /// Enum  toggle mode
        /// </summary>
        public enum ToggleModeType
        {
            /// <summary>
            /// Enum   Tabs
            /// </summary>
            Tabs,

            /// <summary>
            /// Enum  Button
            /// </summary>
            ToggleButton,

            /// <summary>
            /// Enum  Buttons
            /// </summary>
            Buttons,

            /// <summary>
            /// Enum  None
            /// </summary>
            None
        }

        /// <summary>
        /// Enum  mode
        /// </summary>
        public enum ColorSchemeType
        {
            /// <summary>
            /// Enum Custom
            /// </summary>
            Custom,

            /// <summary>
            /// Enum Visual studio
            /// </summary>
            VisualStudio,

            /// <summary>
            /// Enum Default
            /// </summary>
            Default
        }

        /// <summary>
        /// Enum  Tool strip
        /// </summary>
        public enum ToolstripBackgroundImageType
        {
            /// <summary>
            /// Enum  Default
            /// </summary>
            Default,

            /// <summary>
            /// Enum  Visual studio
            /// </summary>
            VisualStudio,

            /// <summary>
            /// Enum  Custom
            /// </summary>
            Custom
        }

        /// <summary>
        /// method for Create Rounded Corner
        /// </summary>
        /// <param name="left">parameter left</param>
        /// <param name="top">parameter top</param>
        /// <param name="color">string color</param>
        /// <returns> returns corner</returns>
        #region IScriptControl Members

        #endregion 

        #region Save EventHandler Classes        
        
        [Description("Width of the control (in pixels).")]
        [Category("Layout")]
        [DefaultValue("500px")]

        /// <summary>
        /// Gets or sets Width
        /// </summary>
        public override Unit Width
        {
            get
            {
                if (base.Width.IsEmpty)
                {
                    base.Width = Unit.Pixel(500);
                }

                return base.Width;
            }

            set
            {
                if (value.Type != UnitType.Pixel)
                {
                    throw new HttpException("Width must be set in pixels");
                }

                base.Width = value;
            }
        }

        [Description("The HTML text to edit.")]
        [Category("Data")]

        /// <summary>
        /// Gets or sets html text
        /// </summary>
        public string Text
        {
            get
            {
                if (this.htmlencodedText != null)
                {
                    this.htmlText = this.ClientDecode(this.htmlencodedText.Value);
                }

                return this.htmlText;
            }

            set
            {
                this.htmlText = value;

                if (this.htmlencodedText == null)
                {
                    return;
                }

                string html = this.ClientEncode(this.htmlText);
                this.htmlencodedText.Value = html;

                if (Page.IsPostBack)
                {
                    this.updatePanel.Update();
                    this.updateHtml = true;
                }
            }
        }

        [Description("Flag if there are unsaved changes to the text.")]
        [Category("Data")]

        /// <summary>
        /// Gets a value indicating whether flag is modified
        /// </summary>
        public bool Modified
        {
            get
            {
                if (this.modifiedFlag != null)
                {
                    return this.modifiedFlag.Value == "true";
                }

                return false;
            }
        }

        [Description("Height of the control (in pixels).")]
        [Category("Layout")]
        [DefaultValue("300px")]

        /// <summary>
        /// Gets or sets Height
        /// </summary>
        public override Unit Height
        {
            get
            {
                if (base.Height.IsEmpty)
                {
                    base.Height = Unit.Pixel(300);
                }

                return base.Height;
            }

            set
            {
                if (value.Type != UnitType.Pixel)
                {
                    throw new HttpException("Height must be set in pixels");
                }

                if (value.Value < 300)
                {
                    value = Unit.Pixel(300);
                }

                base.Height = value;
            }
        }

        [Description("Size of the border around the editor area.")]
        [Category("Layout")]
        [DefaultValue(DefaultEditorBorderSize)]

        /// <summary>
        /// Gets or sets Border size
        /// </summary>
        public int EditorBorderSize
        {
            get
            {
                if (this.ViewState["EditorBorderSize"] != null)
                {
                    return (int)ViewState["EditorBorderSize"];
                }
                else
                {
                    return DefaultEditorBorderSize;
                }
            }

            set
            {
                this.ViewState["EditorBorderSize"] = value;
            }
        }

        [Description("Set the color scheme.")]
        [Category("Appearance")]
        [DefaultValue(HtmlEditor.ColorSchemeType.Custom)]

        /// <summary>
        /// Gets or sets ColorScheme
        /// </summary>
        public HtmlEditor.ColorSchemeType ColorScheme
        {
            get
            {
                if (this.ViewState["ColorScheme"] != null)
                {
                    return (HtmlEditor.ColorSchemeType)ViewState["ColorScheme"];
                }
                else
                {
                    return HtmlEditor.ColorSchemeType.Custom;
                }
            }

            set
            {
                this.ViewState["ColorScheme"] = value;
            }
        }

        [Description("Background color of the control.")]
        [Category("Appearance")]
        [DefaultValue("White")]

        /// <summary>
        /// Gets or sets BackColor
        /// </summary>
        public override Color BackColor
        {
            get
            {
                if (base.BackColor.IsEmpty)
                {
                    base.BackColor = ColorTranslator.FromHtml("White");
                }

                return base.BackColor;
            }

            set
            {
                base.BackColor = value;
            }
        }

        [Description("Default color of the text in the document.")]
        [Category("Appearance")]
        [DefaultValue("Black")]

        /// <summary>
        /// Gets or sets EditorForeColor
        /// </summary>
        public Color EditorForeColor
        {
            get
            {
                if (this.ViewState["EditorForeColor"] != null)
                {
                    return (Color)ViewState["EditorForeColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("Black");
                }
            }

            set
            {
                this.ViewState["EditorForeColor"] = value;
            }
        }

        [Description("Background color of the document.")]
        [Category("Appearance")]
        [DefaultValue("White")]

        /// <summary>
        /// Gets or sets EditorBackColor
        /// </summary>
        public Color EditorBackColor
        {
            get
            {
                if (this.ViewState["EditorBackColor"] != null)
                {
                    return (Color)ViewState["EditorBackColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("White");
                }
            }

            set
            {
                this.ViewState["EditorBackColor"] = value;
            }
        }

        [Description("Color of the border around the editor area.")]
        [Category("Appearance")]
        [DefaultValue("#7f9db9")]

        /// <summary>
        /// Gets or sets EditorBorderColor
        /// </summary>
        public Color EditorBorderColor
        {
            get
            {
                if (this.ViewState["EditorBorderColor"] != null)
                {
                    return (Color)ViewState["EditorBorderColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("#7f9db9");
                }
            }

            set
            {
                this.ViewState["EditorBorderColor"] = value;
            }
        }

        [Description("Color of the inner 1px border around the editor area (EditorBorderSize must be greater than 1px).")]
        [Category("Appearance")]
        [DefaultValue("Gray")]

        /// <summary>
        /// Gets or sets EditorInnerBorderColor
        /// </summary>
        public Color EditorInnerBorderColor
        {
            get
            {
                if (this.ViewState["EditorInnerBorderColor"] != null)
                {
                    return (Color)ViewState["EditorInnerBorderColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("Gray");
                }
            }

            set
            {
                this.ViewState["EditorInnerBorderColor"] = value;
            }
        }

        [Description("Color of the toolbars and document borders.")]
        [Category("Appearance")]
        [DefaultValue("#7f9db9")]

        /// <summary>
        /// Gets or sets ToolbarColor
        /// </summary>
        public Color ToolbarColor
        {
            get
            {
                if (this.ViewState["ToolbarColor"] != null)
                {
                    return (Color)ViewState["ToolbarColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("#7f9db9");
                }
            }

            set
            {
                this.ViewState["ToolbarColor"] = value;
            }
        }

        [Description("Toolstrip background image type.")]
        [Category("Appearance")]
        [DefaultValue(HtmlEditor.ToolstripBackgroundImageType.Default)]

        /// <summary>
        /// Gets or sets Tool strip Background Image
        /// </summary>
        public HtmlEditor.ToolstripBackgroundImageType ToolstripBackgroundImage
        {
            get
            {
                if (this.ViewState["ToolstripBackgroundImage"] != null)
                {
                    return (HtmlEditor.ToolstripBackgroundImageType)ViewState["ToolstripBackgroundImage"];
                }
                else
                {
                    return HtmlEditor.ToolstripBackgroundImageType.Default;
                }
            }

            set
            {
                this.ViewState["ToolstripBackgroundImage"] = value;
            }
        }

        [Description("Toolstrip background images custom path.")]
        [Category("Appearance")]
        [DefaultValue(DefaultToolstripBackgroundImageCustomPath)]

        /// <summary>
        /// Gets or sets Tool strip Background Image CustomPath
        /// </summary>
        public string ToolstripBackgroundImageCustomPath
        {
            get
            {
                if (this.ViewState["ToolstripBackgroundImageCustomPath"] != null)
                {
                    return (string)ViewState["ToolstripBackgroundImageCustomPath"];
                }
                else
                {
                    return DefaultToolstripBackgroundImageCustomPath;
                }
            }

            set
            {
                this.ViewState["ToolstripBackgroundImageCustomPath"] = value;
            }
        }

        [Description("Prevents display of a toolstrip background image.")]
        [Category("Appearance")]
        [DefaultValue(false)]

        /// <summary>
        /// Gets or sets a value indicating whether Tool strip Background Image
        /// </summary>
        public bool NoToolstripBackgroundImage
        {
            get
            {
                if (this.ViewState["NoToolstripBackgroundImage"] != null)
                {
                    return (bool)ViewState["NoToolstripBackgroundImage"];
                }
                else
                {
                    return false;
                }
            }

            set
            {
                this.ViewState["NoToolstripBackgroundImage"] = value;
            }
        }

        [Description("Color of the tab text.")]
        [Category("Appearance")]
        [DefaultValue("Black")]

        /// <summary>
        /// Gets or sets Tab For Color
        /// </summary>
        public Color TabForeColor
        {
            get
            {
                if (this.ViewState["TabForeColor"] != null)
                {
                    return (Color)ViewState["TabForeColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("Black");
                }
            }

            set
            {
                this.ViewState["TabForeColor"] = value;
            }
        }

        [Description("Background color of the unselected tab.")]
        [Category("Appearance")]
        [DefaultValue("LightSteelBlue")]

        /// <summary>
        /// Gets or sets Tab Back Color
        /// </summary>
        public Color TabBackColor
        {
            get
            {
                if (this.ViewState["TabBackColor"] != null)
                {
                    return (Color)ViewState["TabBackColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("LightSteelBlue");
                }
            }

            set
            {
                this.ViewState["TabBackColor"] = value;
            }
        }

        [Description("Background color of the selected tab.")]
        [Category("Appearance")]
        [DefaultValue("#7f9db9")]

        /// <summary>
        /// Gets or sets Selected Tab Back Color
        /// </summary>
        public Color SelectedTabBackColor
        {
            get
            {
                if (this.ViewState["SelectedTabBackColor"] != null)
                {
                    return (Color)ViewState["SelectedTabBackColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("#7f9db9");
                }
            }

            set
            {
                this.ViewState["SelectedTabBackColor"] = value;
            }
        }

        [Description("Color of the selected tab text.")]
        [Category("Appearance")]
        [DefaultValue("White")]

        /// <summary>
        /// Gets or sets Selected Tab Text Color
        /// </summary>
        public Color SelectedTabTextColor
        {
            get
            {
                if (this.ViewState["SelectedTabTextColor"] != null)
                {
                    return (Color)ViewState["SelectedTabTextColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("White");
                }
            }

            set
            {
                this.ViewState["SelectedTabTextColor"] = value;
            }
        }

        [Description("Background color of the tab on mouseover.")]
        [Category("Appearance")]
        [DefaultValue("LightBlue")]

        /// <summary>
        /// Gets or sets Tab Mouse Over Color
        /// </summary>
        public Color TabMouseOverColor
        {
            get
            {
                if (this.ViewState["TabMouseOverColor"] != null)
                {
                    return (Color)ViewState["TabMouseOverColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("LightBlue");
                }
            }

            set
            {
                this.ViewState["TabMouseOverColor"] = value;
            }
        }

        [Description("Background color of the tabbar.")]
        [Category("Appearance")]
        [DefaultValue("White")]

        /// <summary>
        /// Gets or sets Tab bar Back Color
        /// </summary>
        public Color TabbarBackColor
        {
            get
            {
                if (this.ViewState["TabbarBackColor"] != null)
                {
                    return (Color)ViewState["TabbarBackColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("White");
                }
            }

            set
            {
                this.ViewState["TabbarBackColor"] = value;
            }
        }

        [Description("Background color of the toolbar buttons on mouseover.")]
        [Category("Appearance")]
        [DefaultValue("#c1d2ee")]

        /// <summary>
        /// Gets or sets Button Mouse Over Color
        /// </summary>
        public Color ButtonMouseOverColor
        {
            get
            {
                if (this.ViewState["ButtonMouseOverColor"] != null)
                {
                    return (Color)ViewState["ButtonMouseOverColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("#c1d2ee");
                }
            }

            set
            {
                this.ViewState["ButtonMouseOverColor"] = value;
            }
        }

        [Description("Border color of the toolbar buttons on mouseover.")]
        [Category("Appearance")]
        [DefaultValue("#316ac5")]

        /// <summary>
        /// Gets or sets Button Mouse Over Border Color
        /// </summary>
        public Color ButtonMouseOverBorderColor
        {
            get
            {
                if (this.ViewState["ButtonMouseOverBorderColor"] != null)
                {
                    return (Color)ViewState["ButtonMouseOverBorderColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("#316ac5");
                }
            }

            set
            {
                this.ViewState["ButtonMouseOverBorderColor"] = value;
            }
        }

        [Description("Background color of the dialog.")]
        [Category("Appearance")]
        [DefaultValue("GhostWhite")]

        /// <summary>
        /// Gets or sets Dialog BackColor
        /// </summary>
        public Color DialogBackColor
        {
            get
            {
                if (this.ViewState["DialogBackColor"] != null)
                {
                    return (Color)ViewState["DialogBackColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("GhostWhite");
                }
            }

            set
            {
                this.ViewState["DialogBackColor"] = value;
            }
        }

        [Description("Color of the dialog text.")]
        [Category("Appearance")]
        [DefaultValue("Black")]

        /// <summary>
        /// Gets or sets Dialog ForeColor
        /// </summary>
        public Color DialogForeColor
        {
            get
            {
                if (this.ViewState["DialogForeColor"] != null)
                {
                    return (Color)ViewState["DialogForeColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("Black");
                }
            }

            set
            {
                this.ViewState["DialogForeColor"] = value;
            }
        }

        [Description("Color of the dialog heading.")]
        [Category("Appearance")]
        [DefaultValue("LightSteelBlue")]

        /// <summary>
        /// Gets or sets Dialog Heading Color
        /// </summary>
        public Color DialogHeadingColor
        {
            get
            {
                if (this.ViewState["DialogHeadingColor"] != null)
                {
                    return (Color)ViewState["DialogHeadingColor"];
                }
                else
                {
                    return this.TabBackColor;
                }
            }

            set
            {
                this.ViewState["DialogHeadingColor"] = value;
            }
        }

        [Description("Color of the dialog heading text.")]
        [Category("Appearance")]
        [DefaultValue("Black")]

        /// <summary>
        /// Gets or sets Dialog Heading Text Color
        /// </summary>
        public Color DialogHeadingTextColor
        {
            get
            {
                if (this.ViewState["DialogHeadingTextColor"] != null)
                {
                    return (Color)ViewState["DialogHeadingTextColor"];
                }
                else
                {
                    return this.TabForeColor;
                }
            }

            set
            {
                this.ViewState["DialogHeadingTextColor"] = value;
            }
        }

        [Description("Color of the dialog button bar.")]
        [Category("Appearance")]
        [DefaultValue("LightSteelBlue")]

        /// <summary>
        /// Gets or sets Dialog Button Bar Color
        /// </summary>
        public Color DialogButtonBarColor
        {
            get
            {
                if (this.ViewState["DialogButtonBarColor"] != null)
                {
                    return (Color)ViewState["DialogButtonBarColor"];
                }
                else
                {
                    return this.TabBackColor;
                }
            }

            set
            {
                this.ViewState["DialogButtonBarColor"] = value;
            }
        }

        [Description("Color of the dialog table.")]
        [Category("Appearance")]
        [DefaultValue("#eeeeee")]

        /// <summary>
        /// Gets or sets Dialog Table Color
        /// </summary>
        public Color DialogTableColor
        {
            get
            {
                if (this.ViewState["DialogTableColor"] != null)
                {
                    return (Color)ViewState["DialogTableColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("#eeeeee");
                }
            }

            set
            {
                this.ViewState["DialogTableColor"] = value;
            }
        }

        [Description("Color of the dialog tab text.")]
        [Category("Appearance")]
        [DefaultValue("Black")]

        /// <summary>
        /// Gets or sets Dialog Tab Text Color
        /// </summary>
        public Color DialogTabTextColor
        {
            get
            {
                if (this.ViewState["DialogTabTextColor"] != null)
                {
                    return (Color)ViewState["DialogTabTextColor"];
                }
                else
                {
                    return this.TabForeColor;
                }
            }

            set
            {
                this.ViewState["DialogTabTextColor"] = value;
            }
        }

        [Description("Color of the dialog selected tab text.")]
        [Category("Appearance")]
        [DefaultValue("White")]

        /// <summary>
        /// Gets or sets Dialog Selected Tab Text Color
        /// </summary>
        public Color DialogSelectedTabTextColor
        {
            get
            {
                if (this.ViewState["DialogSelectedTabTextColor"] != null)
                {
                    return (Color)ViewState["DialogSelectedTabTextColor"];
                }
                else
                {
                    return this.SelectedTabTextColor;
                }
            }

            set
            {
                this.ViewState["DialogSelectedTabTextColor"] = value;
            }
        }

        [Description("Color of the dialog unselected tab.")]
        [Category("Appearance")]
        [DefaultValue("LightSteelBlue")]

        /// <summary>
        /// Gets or sets Dialog Unselected Tab Color
        /// </summary>
        public Color DialogUnselectedTabColor
        {
            get
            {
                if (this.ViewState["DialogUnselectedTabColor"] != null)
                {
                    return (Color)ViewState["DialogUnselectedTabColor"];
                }
                else
                {
                    return this.TabBackColor;
                }
            }

            set
            {
                this.ViewState["DialogUnselectedTabColor"] = value;
            }
        }

        [Description("Color of the dialog selected tab.")]
        [Category("Appearance")]
        [DefaultValue("#7f9db9")]

        /// <summary>
        /// Gets or sets Dialog Selected Tab Color
        /// </summary>
        public Color DialogSelectedTabColor
        {
            get
            {
                if (this.ViewState["DialogSelectedTabColor"] != null)
                {
                    return (Color)ViewState["DialogSelectedTabColor"];
                }
                else
                {
                    return this.SelectedTabBackColor;
                }
            }

            set
            {
                this.ViewState["DialogSelectedTabColor"] = value;
            }
        }

        [Description("Color of the dialog borders.")]
        [Category("Appearance")]
        [DefaultValue("Black")]

        /// <summary>
        /// Gets or sets Dialog Border Color
        /// </summary>
        public Color DialogBorderColor
        {
            get
            {
                if (this.ViewState["DialogBorderColor"] != null)
                {
                    return (Color)ViewState["DialogBorderColor"];
                }
                else
                {
                    return ColorTranslator.FromHtml("Black");
                }
            }

            set
            {
                this.ViewState["DialogBorderColor"] = value;
            }
        }

        [Description("Convert output to XHTML.")]
        [Category("Behavior")]
        [DefaultValue(true)]

        /// <summary>
        /// Gets or sets a value indicating whether Output XHTML
        /// </summary>
        public bool OutputXHTML
        {
            get
            {
                if (this.ViewState["OutputXHTML"] != null)
                {
                    return (bool)ViewState["OutputXHTML"];
                }
                else
                {
                    return true;
                }
            }

            set
            {
                this.ViewState["OutputXHTML"] = value;
            }
        }

        [Description("Convert deprecated syntax to standards (OutputXHTML must be true).")]
        [Category("Behavior")]
        [DefaultValue(true)]

        /// <summary>
        /// Gets or sets a value indicating whether Convert Deprecated Syntax
        /// </summary>
        public bool ConvertDeprecatedSyntax
        {
            get
            {
                if (this.ViewState["ConvertDeprecatedSyntax"] != null)
                {
                    return (bool)ViewState["ConvertDeprecatedSyntax"];
                }
                else
                {
                    return true;
                }
            }

            set
            {
                this.ViewState["ConvertDeprecatedSyntax"] = value;
            }
        }

        [Description("Convert top-level paragraph elements inserted in Internet Explorer to appropriate break and/or div elements (OutputXHTML and ConvertDeprecatedSyntax must be true).")]
        [Category("Behavior")]
        [DefaultValue(false)]

        /// <summary>
        /// Gets or sets a value indicating whether Convert Paragraphs
        /// </summary>
        public bool ConvertParagraphs
        {
            get
            {
                if (this.ViewState["ConvertParagraphs"] != null)
                {
                    return (bool)ViewState["ConvertParagraphs"];
                }
                else
                {
                    return false;
                }
            }

            set
            {
                this.ViewState["ConvertParagraphs"] = value;
            }
        }

        [Description("Replace nbsp entities inserted in Internet Explorer with spaces (OutputXHTML must be true).")]
        [Category("Behavior")]
        [DefaultValue(false)]

        /// <summary>
        /// Gets or sets a value indicating whether Replace No Break Space
        /// </summary>
        public bool ReplaceNoBreakSpace
        {
            get
            {
                if (this.ViewState["ReplaceNoBreakSpace"] != null)
                {
                    return (bool)ViewState["ReplaceNoBreakSpace"];
                }
                else
                {
                    return false;
                }
            }

            set
            {
                this.ViewState["ReplaceNoBreakSpace"] = value;
            }
        }

        [Description("Display an asterick on the current tab whenever the text has been modified and not yet saved.")]
        [Category("Behavior")]
        [DefaultValue(true)]

        /// <summary>
        /// Gets or sets a value indicating whether Show Modified asterisk
        /// </summary>
        public bool ShowModifiedAsterick
        {
            get
            {
                if (this.ViewState["ShowModifiedAsterick"] != null)
                {
                    return (bool)ViewState["ShowModifiedAsterick"];
                }
                else
                {
                    return true;
                }
            }

            set
            {
                this.ViewState["ShowModifiedAsterick"] = value;
            }
        }

        [Description("Add newline character after block tags in the HTML mode editor (OutputXHTML must be true, IE only).")]
        [Category("Behavior")]
        [DefaultValue(true)]

        /// <summary>
        /// Gets or sets a value indicating whether Format Html Mode
        /// </summary>
        public bool FormatHtmlMode
        {
            get
            {
                if (this.ViewState["FormatHtmlMode"] != null)
                {
                    return (bool)ViewState["FormatHtmlMode"];
                }
                else
                {
                    return true;
                }
            }

            set
            {
                this.ViewState["FormatHtmlMode"] = value;
            }
        }

        [Description("Comma delimited list of allowed tags (OutputXHTML must be true).")]
        [Category("Behavior")]
        [DefaultValue(DefaultAllowedTags)]

        /// <summary>
        /// Gets or sets Allowed Tags
        /// </summary>
        public string AllowedTags
        {
            get
            {
                if (this.ViewState["AllowedTags"] == null)
                {
                    this.ViewState["AllowedTags"] = DefaultAllowedTags;
                }

                return (string)ViewState["AllowedTags"];
            }

            set
            {
                if (value != null)
                {
                    string[] allowedTags = value.Split(',');
                    if (allowedTags.Length > 0)
                    {
                        this.ViewState["AllowedTags"] = this.BuildCommaDelimitedStringFromList(allowedTags, true);
                    }
                }
            }
        }

        [Description("Comma delimited list of allowed attributes (OutputXHTML must be true).")]
        [Category("Behavior")]
        [DefaultValue(DefaultAllowedAttributes)]

        /// <summary>
        /// Gets or sets Allowed Attributes
        /// </summary>
        public string AllowedAttributes
        {
            get
            {
                if (this.ViewState["AllowedAttributes"] == null)
                {
                    this.ViewState["AllowedAttributes"] = DefaultAllowedAttributes;
                }

                return (string)ViewState["AllowedAttributes"];
            }

            set
            {
                if (value != null)
                {
                    string[] allowedAttributes = value.Split(',');
                    if (allowedAttributes.Length > 0)
                    {
                        this.ViewState["AllowedAttributes"] = this.BuildCommaDelimitedStringFromList(allowedAttributes, true);
                    }
                }
            }
        }

        [Description("Comma delimited list of no script attributes (OutputXHTML must be true).")]
        [Category("Behavior")]
        [DefaultValue(DefaultNoScriptAttributes)]

        /// <summary>
        /// Gets or sets Script Attributes
        /// </summary>
        public string NoScriptAttributes
        {
            get
            {
                if (this.ViewState["NoScriptAttributes"] == null)
                {
                    this.ViewState["NoScriptAttributes"] = DefaultNoScriptAttributes;
                }

                return (string)ViewState["NoScriptAttributes"];
            }

            set
            {
                if (value != null)
                {
                    string[] noScriptAttributes = value.Split(',');
                    if (noScriptAttributes.Length > 0)
                    {
                        this.ViewState["NoScriptAttributes"] = this.BuildCommaDelimitedStringFromList(noScriptAttributes, true);
                    }
                }
            }
        }

        [Description("Initial mode on startup.")]
        [Category("Behavior")]
        [DefaultValue(HtmlEditor.Mode.Design)]

        /// <summary>
        /// Gets or sets Initial Mode
        /// </summary>
        public HtmlEditor.Mode InitialMode
        {
            get
            {
                if (this.ViewState["InitialMode"] != null)
                {
                    return (HtmlEditor.Mode)ViewState["InitialMode"];
                }
                else
                {
                    return HtmlEditor.Mode.Design;
                }
            }

            set
            {
                this.ViewState["InitialMode"] = value;
            }
        }

        [Description("Determines if Design Mode is editable.")]
        [Category("Behavior")]
        [DefaultValue(true)]

        /// <summary>
        /// Gets or sets a value indicating whether Design Mode Editable
        /// </summary>
        public bool DesignModeEditable
        {
            get
            {
                if (this.ViewState["DesignModeEditable"] != null)
                {
                    return (bool)ViewState["DesignModeEditable"];
                }
                else
                {
                    return true;
                }
            }

            set
            {
                this.ViewState["DesignModeEditable"] = value;
            }
        }

        [Description("Determines if Html Mode is editable.")]
        [Category("Behavior")]
        [DefaultValue(true)]

        /// <summary>
        /// Gets or sets a value indicating whether Html Mode Editable
        /// </summary>
        public bool HtmlModeEditable
        {
            get
            {
                if (this.ViewState["HtmlModeEditable"] != null)
                {
                    return (bool)ViewState["HtmlModeEditable"];
                }
                else
                {
                    return true;
                }
            }

            set
            {
                this.ViewState["HtmlModeEditable"] = value;
            }
        }

        [Description("Determines the mechanism for switching between modes.")]
        [Category("Behavior")]
        [DefaultValue(HtmlEditor.ToggleModeType.Tabs)]

        /// <summary>
        /// Gets or sets a value indicating whether Toggle Mode
        /// </summary>
        public HtmlEditor.ToggleModeType ToggleMode
        {
            get
            {
                if (this.ViewState["ToggleMode"] != null)
                {
                    return (HtmlEditor.ToggleModeType)ViewState["ToggleMode"];
                }
                else
                {
                    return HtmlEditor.ToggleModeType.Tabs;
                }
            }

            set
            {
                this.ViewState["ToggleMode"] = value;
            }
        }

        [Description("Determines if the toolbar is docked to the editor.")]
        [Category("Behavior")]
        [DefaultValue(true)]

        /// <summary>
        /// Gets or sets a value indicating whether Toolbar Docked
        /// </summary>
        public bool ToolbarDocked
        {
            get
            {
                if (this.ViewState["ToolbarDocked"] != null)
                {
                    return (bool)ViewState["ToolbarDocked"];
                }
                else
                {
                    return true;
                }
            }

            set
            {
                this.ViewState["ToolbarDocked"] = value;
            }
        }

        [Description("Assigns a CSS class to the toolbar (ToolbarDocked must be false).")]
        [Category("Behavior")]
        [DefaultValue(DefaultToolbarClass)]

        /// <summary>
        /// Gets or sets Toolbar Class
        /// </summary>
        public string ToolbarClass
        {
            get
            {
                if (this.ViewState["ToolbarClass"] != null)
                {
                    return (string)ViewState["ToolbarClass"];
                }
                else
                {
                    return DefaultToolbarClass;
                }
            }

            set
            {
                this.ViewState["ToolbarClass"] = value.Trim();
            }
        }

        [Description("Css file to link for Design mode.")]
        [Category("Appearance")]
        [DefaultValue("")]

        /// <summary>
        /// Gets or sets Design Mode 
        /// </summary>
        public string DesignModeCss
        {
            get
            {
                if (this.ViewState["DesignModeCss"] != null)
                {
                    return (string)ViewState["DesignModeCss"];
                }
                else
                {
                    return string.Empty;
                }
            }

            set
            {
                this.ViewState["DesignModeCss"] = value;
            }
        }

        [Description("Determines if the Design Mode document includes the meta tag for emulating IE 7 in IE8 and higher.")]
        [Category("Behavior")]
        [DefaultValue(true)]

        /// <summary>
        /// Gets or sets a value indicating whether Design Mode Emulate IE7
        /// </summary>
        public bool DesignModeEmulateIE7
        {
            get
            {
                if (this.ViewState["DesignModeEmulateIE7"] != null)
                {
                    return (bool)ViewState["DesignModeEmulateIE7"];
                }
                else
                {
                    return true;
                }
            }

            set
            {
                this.ViewState["DesignModeEmulateIE7"] = value;
            }
        }

        [Description("Text direction in Design mode.")]
        [Category("Behavior")]
        [DefaultValue(HtmlEditor.Direction.NotSet)]

        /// <summary>
        /// Gets or sets TextDirection
        /// </summary>
        public HtmlEditor.Direction TextDirection
        {
            get
            {
                if (this.ViewState["TextDirection"] != null)
                {
                    return (HtmlEditor.Direction)ViewState["TextDirection"];
                }
                else
                {
                    return HtmlEditor.Direction.NotSet;
                }
            }

            set
            {
                this.ViewState["TextDirection"] = value;
            }
        }

        [Description("Client-side handler for modified flag change.")]
        [Category("Behavior")]

        /// <summary>
        /// Gets or sets Modified Changed
        /// </summary>
        public string ModifiedChanged
        {
            get
            {
                if (this.ViewState["ModifiedChanged"] != null)
                {
                    return (string)ViewState["ModifiedChanged"];
                }
                else
                {
                    return string.Empty;
                }
            }

            set
            {
                this.ViewState["ModifiedChanged"] = value;
            }
        }

        [Description("Client-side handler for design mode context change.")]
        [Category("Behavior")]

        /// <summary>
        /// Gets or sets Context Changed
        /// </summary>
        public string ContextChanged
        {
            get
            {
                if (this.ViewState["ContextChanged"] != null)
                {
                    return (string)ViewState["ContextChanged"];
                }
                else
                {
                    return string.Empty;
                }
            }

            set
            {
                this.ViewState["ContextChanged"] = value;
            }
        }

        [Description("Definition of toolbar elements.")]
        [Category("Behavior")]
        [DefaultValue(DefaultToolbars)]

        /// <summary>
        /// Gets or sets Toolbars
        /// </summary>
        public string Toolbars
        {
            get
            {
                if (this.ViewState["Toolbars"] == null)
                {
                    this.ViewState["Toolbars"] = DefaultToolbars;
                }

                return (string)ViewState["Toolbars"];
            }

            set
            {
                if (value != null)
                {
                    string toolbars = string.Empty;
                    string[] listToolbars = value.Split(';');

                    foreach (string toolbar in listToolbars)
                    {
                        string toolbarElements = this.BuildCommaDelimitedStringFromList(toolbar.Split(','), false);

                        if (toolbars.Length > 0)
                        {
                            toolbars += ";";
                            toolbars += toolbarElements;
                        }
                    }

                    this.ViewState["Toolbars"] = toolbars;
                }
            }
        }

        [Description("Determines if dialogs can be moved.")]
        [Category("Behavior")]
        [DefaultValue(true)]

        /// <summary>
        /// Gets or sets a value indicating whether Dialog Floating Behavior
        /// </summary>
        public bool DialogFloatingBehavior
        {
            get
            {
                if (this.ViewState["DialogFloatingBehavior"] != null)
                {
                    return (bool)ViewState["DialogFloatingBehavior"];
                }
                else
                {
                    return true;
                }
            }

            set
            {
                this.ViewState["DialogFloatingBehavior"] = value;
            }
        }

        [Description("Determines if modifications are automatically saved as part of client-side validation (CausesValidation must be true for the control clicked).")]
        [Category("Behavior")]
        [DefaultValue(true)]

        /// <summary>
        /// Gets or sets a value indicating whether Auto Save
        /// </summary>
        public bool AutoSave
        {
            get
            {
                if (this.ViewState["AutoSave"] != null)
                {
                    return (bool)ViewState["AutoSave"];
                }
                else
                {
                    return true;
                }
            }

            set
            {
                this.ViewState["AutoSave"] = value;
            }
        }

        [Description("Comma delimited list of ValidationGroup names used by AutoSave (use '*' for all, '.' for default).")]
        [Category("Behavior")]
        [DefaultValue(DefaultAutoSaveValidationGroups)]

        /// <summary>
        /// Gets or sets Auto Save Validation Groups
        /// </summary>
        public string AutoSaveValidationGroups
        {
            get
            {
                object o = ViewState["AutoSaveValidationGroups"];
                if (o != null)
                {
                    return (string)o;
                }

                this.ViewState["AutoSaveValidationGroups"] = DefaultAutoSaveValidationGroups;
                return DefaultAutoSaveValidationGroups;
            }

            set
            {
                if (value != null)
                {
                    string[] autosaveValidationGroups = value.Split(',');
                    if (autosaveValidationGroups.Length > 0)
                    {
                        this.ViewState["AutoSaveValidationGroups"] = this.BuildCommaDelimitedStringFromList(autosaveValidationGroups, false);
                    }
                }
            }
        }

        [Description("Comma delimited list of button ID's requiring Save behavior on a client click (Default search pattern is relative to editor location).")]
        [Category("Behavior")]

        /// <summary>
        /// Gets or sets Save Buttons
        /// </summary>
        public string SaveButtons
        {
            get
            {
                if (this.ViewState["SaveButtons"] == null)
                {
                    this.ViewState["SaveButtons"] = string.Empty;
                }

                return (string)ViewState["SaveButtons"];
            }

            set
            {
                if (value != null)
                {
                    string[] saveButtons = value.Split(',');
                    if (saveButtons.Length > 0)
                    {
                        this.ViewState["SaveButtons"] = this.BuildCommaDelimitedStringFromList(saveButtons, false);
                    }
                }
            }
        }

        /// <summary>
        /// Gets a value indicating whether Design Mode 2008
        /// </summary>
        protected bool DesignMode2008
        {
            get
            {
                if (!this.DesignMode)
                {
                    return false;
                }

                return VisualStudio.Version == "2008";
            }
        }

        /// <summary>
        /// Gets a value indicating whether Internet Explorer
        /// </summary>
        protected bool InternetExplorer
        {
            get { return this.DesignMode ? true : this.Page.Request.Browser.IsBrowser("IE"); }
        }

        /// <summary>
        /// Gets Browser Version
        /// </summary>
        protected int BrowserVersion
        {
            get { return this.DesignMode ? 0 : this.Page.Request.Browser.MajorVersion; }
        }

        /// <summary>
        /// Gets or sets Editor Width
        /// </summary>
        protected int EditorWidth
        {
            get { return this.editorWidth; }
            set { this.editorWidth = value; }
        }

        /// <summary>
        /// Gets or sets Editor Height
        /// </summary>
        protected int EditorHeight
        {
            get { return this.editorHeight; }
            set { this.editorHeight = value; }
        }

        /// <summary>
        /// Gets or sets Tool bar Height
        /// </summary>
        protected int ToolbarHeight
        {
            get { return this.toolbarHeight; }
            set { this.toolbarHeight = value; }
        }

        /// <summary>
        /// Gets  Tool bar Padding
        /// </summary>
        protected int ToolbarPadding
        {
            get { return Math.Max(DefaultEditorBorderSize, this.EditorBorderSize); }
        }

        /// <summary>
        /// Gets  Additional Tool bar Padding
        /// </summary>
        protected int AdditionalToolbarPadding
        {
            get { return this.ToolbarPadding - this.EditorBorderSize; }
        }

        /// <summary>
        /// Gets  Tool strip Padding
        /// </summary>
        protected int ToolstripPadding
        {
            get { return 3; }
        }

        /// <summary>
        /// Gets or sets Tab bar Height
        /// </summary>
        protected int TabbarHeight
        {
            get { return this.tabbarHeight; }
            set { this.tabbarHeight = value; }
        }

        /// <summary>
        /// Gets or sets Tab Height
        /// </summary>
        protected int TabHeight
        {
            get { return this.tabHeight; }
            set { this.tabHeight = value; }
        }

        /// <summary>
        /// Gets or sets Tab Height
        /// </summary>
        protected int TabWidth
        {
            get { return this.tabWidth; }
            set { this.tabWidth = value; }
        }

        /// <summary>
        /// Gets or sets Tab heading Height
        /// </summary>
        protected int DialogHeadingHeight
        {
            get { return this.dialogHeadingHeight; }
            set { this.dialogHeadingHeight = value; }
        }

        /// <summary>
        /// Gets or sets Tab heading Height
        /// </summary>
        protected int DialogButtonBarHeight
        {
            get { return this.dialogButtonBarHeight; }
            set { this.dialogButtonBarHeight = value; }
        }

        /// <summary>
        /// Gets Pixel Image Url
        /// </summary>
        protected string PixelImageUrl
        {
            get { return this.GetWebResourceUrl("Winthusiasm.HtmlEditor.Images.pixel.gif"); }
        }

        /// <summary>
        /// Gets or sets Validation Groups
        /// </summary>
        protected string[] ValidationGroups
        {
            get
            {
                object o = ViewState["ValidationGroups"];
                if
                    (o != null)
                {
                    return (string[])o;
                }

                return this.GetStringList(string.Empty);
            }

            set
            {
                this.ViewState["ValidationGroups"] = value;
            }
        }

        /// <summary>
        /// Gets To Back Color 
        /// </summary>
        protected string ToBackColor
        {
            get { return ColorTranslator.ToHtml(this.BackColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToEditorForeColor
        {
            get { return ColorTranslator.ToHtml(this.EditorForeColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToEditorBackColor
        {
            get { return ColorTranslator.ToHtml(this.EditorBackColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToEditorBorderColor
        {
            get { return ColorTranslator.ToHtml(this.EditorBorderColor); }
        }

        /// <summary>
        /// Gets To editor For border Color
        /// </summary>
        protected string ToEditorInnerBorderColor
        {
            get { return ColorTranslator.ToHtml(this.EditorInnerBorderColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToToolbarColor
        {
            get { return ColorTranslator.ToHtml(this.ToolbarColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToTabForeColor
        {
            get { return ColorTranslator.ToHtml(this.TabForeColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToTabBackColor
        {
            get { return ColorTranslator.ToHtml(this.TabBackColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToSelectedTabBackColor
        {
            get { return ColorTranslator.ToHtml(this.SelectedTabBackColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToSelectedTabTextColor
        {
            get { return ColorTranslator.ToHtml(this.SelectedTabTextColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToTabbarBackColor
        {
            get { return ColorTranslator.ToHtml(this.TabbarBackColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToButtonMouseOverColor
        {
            get { return ColorTranslator.ToHtml(this.ButtonMouseOverColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToDialogBackColor
        {
            get { return ColorTranslator.ToHtml(this.DialogBackColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToDialogForeColor
        {
            get { return ColorTranslator.ToHtml(this.DialogForeColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToDialogHeadingColor
        {
            get { return ColorTranslator.ToHtml(this.DialogHeadingColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToDialogHeadingTextColor
        {
            get { return ColorTranslator.ToHtml(this.DialogHeadingTextColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToDialogButtonBarColor
        {
            get { return ColorTranslator.ToHtml(this.DialogButtonBarColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected string ToDialogBorderColor
        {
            get { return ColorTranslator.ToHtml(this.DialogBorderColor); }
        }

        /// <summary>
        /// Gets To editor For Color
        /// </summary>
        protected override HtmlTextWriterTag TagKey
        {
            get { return HtmlTextWriterTag.Div; }
        }

        /// <summary>
        /// Gets To editor For script object
        /// </summary>
        protected string FindScriptObject
        {
            get { return "$find('" + this.ClientID + "')"; }
        }
        
        /// <summary>
        /// The IScriptControl.GetScriptDescriptors method
        /// </summary>
        /// <returns>type object</returns>        
        IEnumerable<ScriptDescriptor> IScriptControl.GetScriptDescriptors()
        {
            return this.GetScriptDescriptors();
        }

        /// <summary>
        /// The IScriptControl.GetScriptReferences method
        /// </summary>
        /// <returns>type object</returns>        
        IEnumerable<ScriptReference> IScriptControl.GetScriptReferences()
        {
            return this.GetScriptReferences();
        }

        /// <summary>
        /// Gets or sets Revert()
        /// </summary>
        public void Revert()
        {
            this.Text = this.Text;
        }

        /// <summary>
        /// The SaveButton_Click method
        /// </summary>
        /// <param name="sender">The sender parameter</param>
        /// <param name="e">The e parameter</param>        
        public void SaveButton_Click(object sender, EventArgs e)
        {
            this.OnSave(new SaveEventArgs(this));
        }

        /// <summary>
        /// Gets or sets a value indicating whether
        /// </summary>
        /// <param name="control">input control </param>
        public void AttachSaveButton(Control control)
        {
            SaveButtonInfo.AttachButton(this, control);
        }
        
        /// <summary>
        /// Gets or sets Tab heading Height
        /// </summary>
        /// <param name="name">string name </param>
        /// <returns>returns false</returns>
    [SuppressMessage("Microsoft.Maintainability", "CA1500:UsePropertiesWhereAppropriate", Justification = "Reviewed")]
        protected bool HasDialog(string name)
        {
            string[] dialogs = this.dialogData.Split(';');

            foreach (string dialog in dialogs)
            {
                string[] dialogData = dialog.Split(',');
                if (dialogData[0] == name)
                {
                    return true;
                }
            }

            return false;
        }
        
        /// <summary>
        /// Gets or sets Build Comma Delimited string From List
        /// </summary>
        /// <param name="list">string list</param>
        /// <param name="forceLowerCase">force Lower Case</param>
        /// <returns>returns s</returns>
        protected string BuildCommaDelimitedStringFromList(string[] list, bool forceLowerCase)
        {
            string s = string.Empty;
            for (int i = 0; i < list.Length; i++)
            {
                if (i > 0)
                {
                    s += ",";
                }

                string item = list[i].Trim();
                if (forceLowerCase)
                {
                    item = item.ToLowerInvariant();
                    s += item;
                }
            }

            return s;
        }

        /// <summary>
        /// Gets To editor For safe script
        /// </summary>
        /// <param name="method">string method</param>  
        /// <returns>returns variable e</returns>
        protected string GetSafeScriptMethod(string method)
        {
            return "var e = " + this.FindScriptObject + "; if (e) { e." + method + "; }";
        }

        /// <summary>
        /// field for For web resource
        /// </summary>
        /// <param name="resource">string resource</param>
        /// <returns>returns resource</returns>
        protected string GetWebResourceUrl(string resource)
        {
            return Page.ClientScript.GetWebResourceUrl(typeof(Winthusiasm.HtmlEditor.HtmlEditor), resource);
        }

        /// <summary>
        /// field for For web resource
        /// </summary>
        /// <param name="resource">string resource</param>
        /// <returns>returns resource</returns>
        protected string GetEncodedWebResourceUrl(string resource)
        {
            return HttpUtility.HtmlEncode(Page.ClientScript.GetWebResourceUrl(typeof(Winthusiasm.HtmlEditor.HtmlEditor), resource));
        }

        /// <summary>
        /// field for For Client Encode
        /// </summary>
        /// <param name="html">string html</param>
        /// <returns>returns html</returns>
        protected string ClientEncode(string html)
        {
            html = html.Replace("&quot;", "&quotx;");
            html = html.Replace("\"", "&quot;");
            html = html.Replace("&amp;", "&ampx;");
            html = html.Replace("&", "&amp;");
            html = html.Replace("&lt;", "&ltx;");
            html = html.Replace("<", "&lt;");
            html = html.Replace("&gt;", "&gtx;");
            html = html.Replace(">", "&gt;");

            return html;
        }        

        /// <summary>
        /// field for For Client Decode
        /// </summary>
        /// <param name="html">string html</param>
        /// <returns>returns html</returns>
        protected string ClientDecode(string html)
        {
            html = html.Replace("&gt;", ">");
            html = html.Replace("&gtx;", "&gt;");
            html = html.Replace("&lt;", "<");
            html = html.Replace("&ltx;", "&lt;");
            html = html.Replace("&amp;", "&");
            html = html.Replace("&ampx;", "&amp;");
            html = html.Replace("&quot;", "\"");
            html = html.Replace("&quotx;", "&quot;");

            return html;
        }

        /// <summary>
        /// The GetStringList method
        /// </summary>
        /// <param name="commaDelimitedList">The commaDelimitedList parameter</param>
        /// <returns>The string[] type object</returns>        
        protected string[] GetStringList(string commaDelimitedList)
        {
            string[] stringList = commaDelimitedList.Split(',');
            if (stringList.Length == 1 && stringList[0] == string.Empty)
            {
                return new List<string>().ToArray();
            }

            return stringList;
        }

        /// <summary>
        /// method for Get ClientIDs
        /// </summary>
        /// <param name="controls">control controls</param>
        /// <returns> clientIDs List</returns>
        protected string GetClientIDs(Control[] controls)
        {
            string clientIDs = string.Empty;

            foreach (Control control in controls)
            {
                if (clientIDs.Length > 0)
                {
                    clientIDs += ";";
                }

                clientIDs += control.ClientID;
            }

            return clientIDs;
        }

        /// <summary>
        /// method for Get Design Mode 
        /// </summary>
        /// <returns> Resolve Client Url</returns>
        protected string GetDesignModeCss()
        {
            if (this.DesignModeCss.Length == 0)
            {
                return string.Empty;
            }
            else
            {
                return this.Page.ResolveClientUrl(this.DesignModeCss);
            }
        }

        /// <summary>
        /// method for Create Dialog Box
        /// </summary>
        protected void CreateDialogBox()
        {
            HtmlGenericControl dialogShim = new HtmlGenericControl("div");
            dialogShim.Style["position"] = "relative";
            dialogShim.Style["left"] = "0px";
            dialogShim.Style["top"] = "0px";
            dialogShim.Style["height"] = "0px";
            dialogShim.Style["width"] = "0px";
            dialogShim.Style["z-index"] = "1";

            Panel dialogBox = new Panel();
            dialogBox.ID = "DialogBox";
            dialogBox.Style["display"] = this.DesignMode2008 ? "block" : "none";
            dialogBox.Style["position"] = "absolute";
            dialogBox.Style["left"] = "50px";
            dialogBox.Style["top"] = "75px";
            dialogBox.Style["height"] = "200px";
            dialogBox.Style["width"] = "300px";
            dialogBox.Style["border"] = "solid 1px " + this.ToDialogBorderColor;
            dialogBox.Style["background-color"] = this.ToDialogBackColor;
            dialogBox.Style["color"] = this.ToDialogForeColor;
            dialogBox.Style["z-index"] = "2";

            HtmlGenericControl dialogHeading = new HtmlGenericControl("div");
            dialogHeading.ID = "DialogHeading";
            dialogHeading.Style["position"] = "relative";
            dialogHeading.Style["left"] = "0px";
            dialogHeading.Style["top"] = "0px";
            dialogHeading.Style["height"] = this.DialogHeadingHeight.ToString() + "px";
            dialogHeading.Style["line-height"] = "29px";
            dialogHeading.Style["font-family"] = "Verdana";
            dialogHeading.Style["font-size"] = "12pt";
            dialogHeading.Style["font-weight"] = "bold";
            dialogHeading.Style["text-align"] = "center";
            dialogHeading.Style["background-color"] = this.ToDialogHeadingColor;
            dialogHeading.Style["color"] = this.ToDialogHeadingTextColor;
            dialogHeading.Style["border-bottom"] = "solid 1px " + this.ToDialogBorderColor;

            if (this.DialogFloatingBehavior)
            {
                dialogHeading.Attributes["onmousedown"] = this.GetSafeScriptMethod("Drag(this.parentNode, event)");
                dialogHeading.Style["cursor"] = "move";
            }

            string frameTag = this.DesignMode2008 ? "div" : "iframe";

            HtmlGenericControl dialogFrame = new HtmlGenericControl(frameTag);
            dialogFrame.ID = "DialogFrame";
            dialogFrame.Style["display"] = "block";
            dialogFrame.Style["background-color"] = this.ToDialogBackColor;

            if (this.DesignMode2008)
            {
                int frameHeight = 200 - this.DialogHeadingHeight - this.DialogButtonBarHeight - 2;
                dialogFrame.Style["height"] = frameHeight.ToString() + "px";
            }
            else
            {
                dialogFrame.Attributes["width"] = "100%";
                dialogFrame.Attributes["frameborder"] = "0";
            }

            HtmlGenericControl dialogButtons = new HtmlGenericControl("div");
            dialogButtons.ID = "DialogButtons";
            dialogButtons.Style["height"] = this.DialogButtonBarHeight.ToString() + "px";
            dialogButtons.Style["text-align"] = "center";
            dialogButtons.Style["border-top"] = "solid 1px " + this.ToDialogBorderColor;
            dialogButtons.Style["background-color"] = this.ToDialogButtonBarColor;

            Button dialogOKButton = new Button();
            dialogOKButton.ID = "DialogOKButton";
            dialogOKButton.Text = "OK";
            dialogOKButton.OnClientClick = this.GetSafeScriptMethod("OnDialogOK()") + "; return false;";
            dialogOKButton.Style["width"] = "75px";
            dialogOKButton.Style["font-family"] = "Verdana";
            dialogOKButton.Style["font-size"] = "8pt";
            dialogOKButton.Style["margin-top"] = "5px";

            Button dialogCancelButton = new Button();
            dialogCancelButton.ID = "DialogCancelButton";
            dialogCancelButton.Text = "Cancel";
            dialogCancelButton.OnClientClick = this.GetSafeScriptMethod("CloseDialogBox()") + "; return false;";
            dialogCancelButton.Style["width"] = "75px";
            dialogCancelButton.Style["font-family"] = "Verdana";
            dialogCancelButton.Style["font-size"] = "8pt";
            dialogCancelButton.Style["margin-top"] = "5px";

            dialogButtons.Controls.Add(dialogOKButton);
            dialogButtons.Controls.Add(dialogCancelButton);

            dialogBox.Controls.Add(dialogHeading);
            dialogBox.Controls.Add(dialogFrame);
            dialogBox.Controls.Add(dialogButtons);

            dialogShim.Controls.Add(dialogBox);

            this.Controls.Add(dialogShim);

            Control[] controls = { dialogShim, dialogBox, dialogHeading, dialogFrame };
            this.dialogBoxIDs = this.GetClientIDs(controls);
        }

        /// <summary>
        /// The CreateRoundedCorner method
        /// </summary>
        /// <param name="left">The left parameter</param>
        /// <param name="top">The top parameter</param>
        /// <param name="color">The color parameter</param>
        /// <returns>The System.Web.UI.HtmlControls.HtmlImage type object</returns>        
        protected HtmlImage CreateRoundedCorner(bool left, bool top, string color)
        {
            string leftRight = left ? "left" : "right";
            string topBottom = top ? "top" : "bottom";
            string leftRightPosition = "0px";
            string topBottomPosition = "0px";

            if (!this.DesignMode)
            {
                bool ie6 = this.InternetExplorer &&
                           this.Page.Request.Browser.MajorVersion < 7;

                if (ie6 && !top && !left)
                {
                    leftRightPosition = "-1px";
                }
            }

            HtmlImage corner = new HtmlImage();
            string resource = "Winthusiasm.HtmlEditor.Images.pixel.gif";
            corner.Src = this.GetEncodedWebResourceUrl(resource);
            corner.Height = 1;
            corner.Width = 1;
            corner.Attributes["alt"] = string.Empty;
            corner.Style["position"] = "absolute";
            corner.Style[leftRight] = leftRightPosition;
            corner.Style[topBottom] = topBottomPosition;
            corner.Style["margin"] = "0px";
            corner.Style["padding"] = "0px";
            corner.Style["background-color"] = color;
            corner.Style["font-size"] = "0px";

            return corner;
        }

        /// <summary>
        /// method for Create Select List
        /// </summary>
        /// <param name="name">parameter name</param>
        /// <returns> returns selectList</returns>
        protected SelectInfo.SelectList CreateSelectList(string name)
        {
            SelectInfo.SelectList selectList = new SelectInfo.SelectList();

            switch (name)
            {
                case "Format":
                    selectList.Add("Normal", "p");
                    if (!this.ConvertParagraphs)
                    {
                        selectList.Add("Paragraph", "p");
                    }

                    selectList.Add("Heading 1", "h1");
                    selectList.Add("Heading 2", "h2");
                    selectList.Add("Heading 3", "h3");
                    selectList.Add("Heading 4", "h4");
                    selectList.Add("Heading 5", "h5");
                    selectList.Add("Heading 6", "h6");
                    selectList.Add("Address", "address");
                    selectList.Add("Formatted", "pre");
                    break;
                case "Font":
                    selectList.Add("Font", string.Empty);
                    selectList.Add("Arial", "Arial");
                    selectList.Add("Courier New", "Courier New");
                    selectList.Add("Garamond", "Garamond");
                    selectList.Add("Sans Serif", "Sans Serif");
                    selectList.Add("Tahoma", "Tahoma");
                    selectList.Add("Times", "Times New Roman");
                    selectList.Add("Verdana", "Verdana");
                    selectList.Add("Wingdings", "Wingdings");
                    break;
                case "Size":
                    selectList.Add("Size", string.Empty);
                    selectList.Add("Very Small", "1");
                    selectList.Add("Smaller", "2");
                    selectList.Add("Small", "3");
                    selectList.Add("Medium", "4");
                    selectList.Add("Large", "5");
                    selectList.Add("Larger", "6");
                    selectList.Add("Very Large", "7");
                    break;
                default:
                    throw new HttpException(string.Format("Invalid select list name: {0}", name));
            }

            return selectList;
        }

        /// <summary>
        /// method for Create Button Info
        /// </summary>
        /// <param name="name">parameter name</param>
        /// <returns> returns designButtonInfo</returns>
        protected ButtonInfo CreateButtonInfo(string name)
        {
            switch (name)
            {
                case "ForeColor":
                    return new ButtonInfo(this, name, "Text Color");
                case "BackColor":
                    return new ButtonInfo(this, name, "Background Color");
                case "Bold":
                    return new ButtonInfo(this, name, "Bold");
                case "Italic":
                    return new ButtonInfo(this, name, "Italic");
                case "Underline":
                    return new ButtonInfo(this, name, "Underline");
                case "Left":
                    return new ButtonInfo(this, name, "Left");
                case "Center":
                    return new ButtonInfo(this, name, "Center");
                case "Right":
                    return new ButtonInfo(this, name, "Right");
                case "Justify":
                    return new ButtonInfo(this, name, "Justify");
                case "OrderedList":
                    return new ButtonInfo(this, name, "Ordered List");
                case "BulletedList":
                    return new ButtonInfo(this, name, "Bulleted List");
                case "Indent":
                    return new ButtonInfo(this, name, "Indent");
                case "Outdent":
                    return new ButtonInfo(this, name, "Outdent");
                case "Rule":
                    return new ButtonInfo(this, name, "Horizontal Rule");
                case "Subscript":
                    return new ButtonInfo(this, name, "Subscript");
                case "Superscript":
                    return new ButtonInfo(this, name, "Superscript");
                case "Link":
                    return new ButtonInfo(this, name, "Hyperlink");
                case "Image":
                    return new ButtonInfo(this, name, "Image");
                case "Design":
                    ButtonInfo designButtonInfo = new ButtonInfo(this, name, "Design Mode");
                    designButtonInfo.Enabled = ToolbarElement.EnabledType.Html;
                    designButtonInfo.Dependency = ToolbarElement.DependencyType.None;
                    designButtonInfo.DisableMethod = this.ToggleMode == ToggleModeType.ToggleButton ? ToolbarElement.DisableMethodType.Hide : ToolbarElement.DisableMethodType.Opacity;
                    return designButtonInfo;
                case "Html":
                    string htmlToolTip = this.HtmlModeEditable ? "Html Mode" : "View Html";
                    ButtonInfo htmlButtonInfo = new ButtonInfo(this, name, htmlToolTip);
                    htmlButtonInfo.Enabled = ToolbarElement.EnabledType.Design;
                    htmlButtonInfo.Dependency = ToolbarElement.DependencyType.None;
                    htmlButtonInfo.DisableMethod = this.ToggleMode == ToggleModeType.ToggleButton ? ToolbarElement.DisableMethodType.Hide : ToolbarElement.DisableMethodType.Opacity;
                    return htmlButtonInfo;
                case "View":
                    ButtonInfo viewButtonInfo = new ButtonInfo(this, name, "View Mode");
                    viewButtonInfo.Enabled = ToolbarElement.EnabledType.Html;
                    viewButtonInfo.Dependency = ToolbarElement.DependencyType.None;
                    viewButtonInfo.DisableMethod = this.ToggleMode == ToggleModeType.ToggleButton ? ToolbarElement.DisableMethodType.Hide : ToolbarElement.DisableMethodType.Opacity;
                    return viewButtonInfo;
                case "Save":
                    ButtonInfo saveButtonInfo = new ButtonInfo(this, name, "Save");
                    saveButtonInfo.Enabled = ToolbarElement.EnabledType.Never;
                    saveButtonInfo.Dependency = ToolbarElement.DependencyType.Editable;
                    return saveButtonInfo;
                case "New":
                    ButtonInfo newButtonInfo = new ButtonInfo(this, name, "New");
                    newButtonInfo.Enabled = ToolbarElement.EnabledType.Always;
                    newButtonInfo.Dependency = ToolbarElement.DependencyType.Editable;
                    return newButtonInfo;
                default:
                    throw new HttpException(string.Format("Invalid button name: {0}", name));
            }
        }

        /// <summary>
        /// method for Split Toolbar Element
        /// </summary>
        /// <param name="toolbarElement">parameter toolbarElement</param>
        /// <param name="elementType">parameter elementType</param>
        /// <param name="elementName">parameter elementName</param>
        protected void SplitToolbarElement(string toolbarElement, out string elementType, out string elementName)
        {
            string[] elementItems = toolbarElement.Split('#');

            if (elementItems.Length > 1)
            {
                elementType = elementItems[0];
                elementName = elementItems[1];
            }
            else
            {
                elementType = "Button";
                elementName = elementItems[0];
            }
        }

        /// <summary>
        /// method for Get Button Names
        /// </summary>
        /// <returns> returns button Names</returns>
        protected List<string> GetButtonNames()
        {
            List<string> buttonNames = new List<string>();

            string[] toolbars = this.Toolbars.Split(';');
            foreach (string toolbarElements in toolbars)
            {
                List<ToolstripData> toolstrips = ToolstripData.CreateToolstripData(toolbarElements);
                buttonNames.AddRange(ToolstripData.GetButtonNames(toolstrips));
            }

            return buttonNames;
        }

        /// <summary>
        /// method for Insert Tool strip Data Item
        /// </summary>
        /// <param name="index">parameter index</param>
        /// <param name="toolstrips">parameter tool strips</param>
        /// <param name="toolstripItemType">parameter tool strip Item Type</param>
        /// <param name="name">parameter name</param>
        protected void InsertToolstripDataItem(int index, List<ToolstripData> toolstrips, ToolstripData.ToolstripItemType toolstripItemType, string name)
        {
            if (toolstrips.Count == 0)
            {
                toolstrips.Add(new ToolstripData());
            }

            ToolstripData toolstripData = toolstrips[0];
            toolstripData.Items.Insert(index, new ToolstripData.ToolstripItemData(toolstripItemType, name));
        }

        /// <summary>
        /// method for Insert Tool strip Data Item
        /// </summary>
        /// <param name="toolstripsBottomToolbar">parameter tool strips Bottom Toolbar</param>
        protected void AddToggleModeButtons(List<ToolstripData> toolstripsBottomToolbar)
        {
            switch (this.ToggleMode)
            {
                case ToggleModeType.ToggleButton:
                case ToggleModeType.Buttons:
                    break;
                default:
                    return;
            }

            List<string> toolbarButtons = this.GetButtonNames();

            string designModeButtonName = this.DesignModeEditable ? "Design" : "View";
            bool hasDesignModeButton = toolbarButtons.Contains(designModeButtonName);
            bool hasHtmlModeButton = toolbarButtons.Contains("Html");
            int insertCount = 0;

            if (!hasHtmlModeButton)
            {
                this.InsertToolstripDataItem(0, toolstripsBottomToolbar, ToolstripData.ToolstripItemType.Button, "Html");
                insertCount++;
            }

            if (!hasDesignModeButton)
            {
                this.InsertToolstripDataItem(0, toolstripsBottomToolbar, ToolstripData.ToolstripItemType.Button, designModeButtonName);
                insertCount++;
            }

            if (insertCount > 0)
            {
                if (toolstripsBottomToolbar[0].Items.Count > insertCount)
                {
                    this.InsertToolstripDataItem(insertCount, toolstripsBottomToolbar, ToolstripData.ToolstripItemType.Separator, string.Empty);
                }
            }
        }

        /// <summary>
        /// method for Insert Tool strip Data Item
        /// </summary>
        /// <param name="toolbarInfoList">parameter tool strips Bottom Toolbar</param>
        protected void PackToolbarInfoList(List<ToolbarInfo> toolbarInfoList)
        {
            for (int i = toolbarInfoList.Count - 1; i >= 0; i--)
            {
                if (toolbarInfoList[i].Deleted)
                {
                    toolbarInfoList.RemoveAt(i);
                }
            }
        }

        /// <summary>
        /// method for Create Select List
        /// </summary>
        /// <param name="toolstripInfo">parameter tool strip Info</param>
        /// <param name="buttons">parameter buttons</param>
        /// <param name="buttonsReference">parameter buttons Reference</param>
        protected void FlushButtonInfo(ToolstripInfo toolstripInfo, ref List<ButtonInfo> buttons, ref int buttonsReference)
        {
            if (buttons.Count == 0)
            {
                return;
            }

            toolstripInfo.Items.Add(new ToolstripInfo.ToolstripItemInfo(ToolstripInfo.ElementType.Buttons, new ButtonBarInfo("Buttons" + buttonsReference.ToString(), buttons)));
            buttons = new List<ButtonInfo>();
            buttonsReference++;
        }

        /// <summary>
        /// method for Create Toolbar Information
        /// </summary>
        /// <param name="toolstrips">parameter tool strips</param>
        /// <param name="row">parameter row</param>
        /// <returns> returns toolbarInfo</returns>
        protected ToolbarInfo CreateToolbarInformation(ToolstripData[] toolstrips, int row)
        {
            ToolbarInfo toolbarInfo = new ToolbarInfo("Toolbar" + row.ToString());
            int buttonsReference = 1;

            foreach (ToolstripData toolstripData in toolstrips)
            {
                ToolstripInfo toolstripInfo = new ToolstripInfo();

                string previousType = "None";
                List<ButtonInfo> buttons = new List<ButtonInfo>();

                for (int i = 0; i < toolstripData.Items.Count; i++)
                {
                    ToolstripData.ToolstripItemData item = toolstripData.Items[i];

                    switch (item.Type)
                    {
                        case ToolstripData.ToolstripItemType.Button:
                            buttons.Add(this.CreateButtonInfo(item.Name));
                            break;
                        case ToolstripData.ToolstripItemType.Select:
                            this.FlushButtonInfo(toolstripInfo, ref buttons, ref buttonsReference);
                            SelectInfo.SelectList selectList = this.CreateSelectList(item.Name);
                            toolstripInfo.Items.Add(new ToolstripInfo.ToolstripItemInfo(ToolstripInfo.ElementType.Select, new SelectInfo(this, item.Name, selectList, "Do" + item.Name, false)));
                            break;
                        case ToolstripData.ToolstripItemType.Separator:
                            this.FlushButtonInfo(toolstripInfo, ref buttons, ref buttonsReference);
                            toolstripInfo.Items.Add(new ToolstripInfo.ToolstripItemInfo(ToolstripInfo.ElementType.Separator, new SeparatorInfo()));
                            break;
                        default:
                            throw new HttpException(string.Format("Invalid toolbar element type: {0}", item.Type));
                    }

                    previousType = item.Type.ToString();
                }

                this.FlushButtonInfo(toolstripInfo, ref buttons, ref buttonsReference);
                toolbarInfo.Toolstrips.Add(toolstripInfo);
            }

            return toolbarInfo;
        }

        /// <summary>
        /// method for Create Toolbar Information
        /// </summary>
        /// <returns> returns toolbarInfoList.ToArray</returns>
        protected ToolbarInfo[] CreateToolbarInfoList()
        {
            List<ToolbarInfo> toolbarInfoList = new List<ToolbarInfo>();

            string[] toolbars = this.Toolbars.Length == 0 ? new string[] { } : this.Toolbars.Split(';');

            for (int i = 0; i < toolbars.Length; i++)
            {
                bool lastToolbar = toolbars.Length == i + 1;

                List<ToolstripData> toolstrips = ToolstripData.CreateToolstripData(toolbars[i]);
                if (lastToolbar)
                {
                    this.AddToggleModeButtons(toolstrips);
                }

                toolbarInfoList.Add(this.CreateToolbarInformation(toolstrips.ToArray(), i + 1));
            }

            this.OnCreateToolbarInfo(new CreateToolbarInfoEventArgs(this, toolbarInfoList));
            this.PackToolbarInfoList(toolbarInfoList);

            return toolbarInfoList.ToArray();
        }

        /// <summary>
        /// method for Create Toolbar Information
        /// </summary>
        /// <param name="selectInfo">parameter name</param>
        /// <param name="previousType">parameter previousType</param>
        /// <param name="baseKey">parameter baseKey</param>
        /// <param name="toolbarControlList">parameter toolbar //ControlList</param>
        /// <returns> returns toolbarInfo</returns>
        protected HtmlSelect CreateHtmlSelect(SelectInfo selectInfo, string previousType, string baseKey, ToolbarControlList toolbarControlList)
        {
            HtmlSelect htmlSelect = new HtmlSelect();
            toolbarControlList.Add(baseKey + "." + selectInfo.Name, htmlSelect);

            htmlSelect.Style["font-family"] = "Verdana";
            htmlSelect.Style["font-size"] = "8pt";
            htmlSelect.Style["width"] = "100px";
            htmlSelect.Style["vertical-align"] = "middle";
            htmlSelect.Style["margin-right"] = "2px";
            htmlSelect.Style["display"] = this.IsToolbarElementHidden(selectInfo) ? "none" : "inline";

            foreach (string key in selectInfo.Items.Keys)
            {
                ListItem option = new ListItem(key, selectInfo.Items[key]);
                htmlSelect.Items.Add(option);
            }

            htmlSelect.Attributes["onchange"] = selectInfo.OnChange;

            return htmlSelect;
        }

        /// <summary>
        /// method for Create Toolbar Information
        /// </summary>
        /// <param name="toolbarElement">parameter toolbarElement</param>
        /// <returns> returns toolbar Element</returns>
        protected bool IsToolbarElementHidden(ToolbarElement toolbarElement)
        {
            if (toolbarElement.DisableMethod != ToolbarElement.DisableMethodType.Hide)
            {
                {
                    return false;
                }
            }

            if (toolbarElement.Enabled == ToolbarElement.EnabledType.Never)
            {
                return true;
            }

            if (toolbarElement.Enabled == ToolbarElement.EnabledType.Always)
            {
                return false;
            }

            return toolbarElement.Enabled.ToString() != this.InitialMode.ToString();
        }

        /// <summary>
        /// method for Create Button Bar
        /// </summary>
        /// <param name="buttonBarInfo">parameter button Bar Info</param>
        ///  <param name="previousType">parameter previous Type</param>
        ///   <param name="baseKey">parameter base Key</param>
        ///    <param name="toolbarControlList">parameter toolbar Control List</param>
        /// <returns> returns buttonBar</returns>
        protected HtmlGenericControl CreateButtonBar(ButtonBarInfo buttonBarInfo, string previousType, string baseKey, ToolbarControlList toolbarControlList)
        {
            HtmlGenericControl buttonBar = new HtmlGenericControl("div");
            buttonBar.Style["display"] = this.IsToolbarElementHidden(buttonBarInfo) ? "none" : "inline";

            baseKey += "." + buttonBarInfo.Name;
            toolbarControlList.Add(baseKey, buttonBar);

            bool ie6 = this.InternetExplorer && this.BrowserVersion < 7;
            string imgBorderStyle = ie6 ? "padding" : "border";
            string imgBorderValue = ie6 ? "1px" : "1px solid";

            foreach (ButtonInfo buttonInfo in buttonBarInfo.Buttons)
            {
                HtmlImage img = new HtmlImage();
                toolbarControlList.Add(baseKey + "." + buttonInfo.Name, img);

                img.Src = buttonInfo.ImageSrc;
                img.Alt = buttonInfo.ToolTip;
                img.Style["vertical-align"] = "middle";
                img.Style[imgBorderStyle] = imgBorderValue;
                img.Style["border-color"] = "transparent";
                img.Style["background-color"] = "transparent";
                img.Style["display"] = this.IsToolbarElementHidden(buttonInfo) ? "none" : "inline";
                img.Attributes["alt"] = buttonInfo.ToolTip;
                img.Attributes["title"] = buttonInfo.ToolTip;
                img.Attributes["onmouseover"] = buttonInfo.OnMouseOver;
                img.Attributes["onmouseout"] = buttonInfo.OnMouseOut;
                img.Attributes["onclick"] = buttonInfo.OnClick;

                buttonBar.Controls.Add(img);
            }

            switch (previousType)
            {
                case "Select":
                    buttonBar.Style["margin-left"] = "8px";
                    break;
                default:
                    break;
            }

            return buttonBar;
        }

        /// <summary>
        /// method for Create Separator
        /// </summary>
        /// <returns> returns separator</returns>
        protected HtmlGenericControl CreateSeparator()
        {
            HtmlGenericControl separator = new HtmlGenericControl("div");
            separator.Style["display"] = "inline";

            HtmlImage img = new HtmlImage();
            string resource;
            string imageSrc;

            bool ie6 = this.InternetExplorer && this.BrowserVersion < 7;
            string imgBorderStyle = ie6 ? "padding" : "border";
            string imgBorderValue = ie6 ? "1px" : "1px solid";

            switch (this.ToolstripBackgroundImage)
            {
                case ToolstripBackgroundImageType.Custom:
                    imageSrc = this.ToolstripBackgroundImageCustomPath + "/separator.gif";
                    break;
                default:
                    resource = "Winthusiasm.HtmlEditor.Images.Toolstrips." + this.ToolstripBackgroundImage.ToString() + ".separator.gif";
                    imageSrc = this.GetEncodedWebResourceUrl(resource);
                    break;
            }

            if (this.NoToolstripBackgroundImage)
            {
                resource = "Winthusiasm.HtmlEditor.Images.separator.gif";
                imageSrc = this.GetEncodedWebResourceUrl(resource);
            }

            img.Src = imageSrc;
            img.Attributes["alt"] = string.Empty;
            img.Style["vertical-align"] = "middle";
            img.Style[imgBorderStyle] = imgBorderValue;
            img.Style["border-color"] = "transparent";
            img.Style["background-color"] = "transparent";
            img.Style["display"] = "inline";

            separator.Controls.Add(img);

            return separator;
        }

        /// <summary>
        /// method for Create Toolbar Information
        /// </summary>
        /// <param name="height">parameter height</param>
        /// <param name="width">parameter width</param>
        /// <returns> returns paddingBox</returns>
        protected HtmlGenericControl CreatePadding(int height, int width)
        {
            HtmlGenericControl paddingBox = new HtmlGenericControl("div");
            paddingBox.Style["display"] = "inline";

            HtmlImage img = new HtmlImage();
            string resource = "Winthusiasm.HtmlEditor.Images.pixel.gif";
            img.Src = this.GetEncodedWebResourceUrl(resource);
            img.Attributes["alt"] = string.Empty;
            img.Style["height"] = height.ToString() + "px";
            img.Style["width"] = width.ToString() + "px";
            img.Style["vertical-align"] = "middle";

            paddingBox.Controls.Add(img);

            return paddingBox;
        }

        /// <summary>
        /// method for Create Toolbar Information
        /// </summary>
        /// <param name="toolbarInfo">parameter toolbarInfo</param>
        /// <param name="toolbarControlList">parameter toolbarControlList</param>
        /// <param name="first">parameter first</param>
        /// <param name="last">parameter last</param>
        /// <returns> returns toolbar</returns>
        protected Toolbar CreateToolbar(ToolbarInfo toolbarInfo, ToolbarControlList toolbarControlList, bool first, bool last)
        {
            Toolbar toolbar = new Toolbar(this);

            string key = toolbarInfo.Name;
            toolbarControlList.Add(key, toolbar);

            if (first)
            {
                toolbar.Style["position"] = "relative";
                toolbar.Style["left"] = "0px";
                toolbar.Style["top"] = "0px";
                toolbar.Style["padding-top"] = this.ToolbarPadding.ToString() + "px";

                if (this.ToolbarDocked)
                {
                    toolbar.Controls.Add(this.CreateRoundedCorner(true, true, this.ToBackColor));
                    toolbar.Controls.Add(this.CreateRoundedCorner(false, true, this.ToBackColor));
                }
            }
            else
            {
                toolbar.Style["margin-top"] = "1px";
            }

            if (last)
            {
                int paddingBottom = this.ToolbarDocked ? this.AdditionalToolbarPadding : this.ToolbarPadding;
                toolbar.Style["padding-bottom"] = paddingBottom.ToString() + "px";
            }

            toolbar.Style["display"] = this.IsToolbarElementHidden(toolbarInfo) ? "none" : "block";

            for (int i = 0; i < toolbarInfo.Toolstrips.Count; i++)
            {
                ToolstripInfo toolstripInfo = toolbarInfo.Toolstrips[i];

                Toolstrip toolStrip = new Toolstrip(this);
                int toolstripPadding = i == 0 ? this.ToolbarPadding : this.ToolstripPadding;
                toolStrip.Style["margin-left"] = toolstripPadding.ToString() + "px";
                toolStrip.Style["float"] = "left";

                toolbar.Controls.Add(toolStrip);

                toolStrip.AddToolbarElement(this.CreatePadding(this.ToolbarHeight, this.ToolstripPadding));

                string previousType = "None";

                foreach (ToolstripInfo.ToolstripItemInfo item in toolstripInfo.Items)
                {
                    switch (item.Type)
                    {
                        case ToolstripInfo.ElementType.Select:
                            SelectInfo selectInfo = (SelectInfo)item.Element;
                            toolStrip.AddToolbarElement(this.CreateHtmlSelect(selectInfo, previousType, key, toolbarControlList));
                            break;
                        case ToolstripInfo.ElementType.Buttons:
                            ButtonBarInfo buttonBarInfo = (ButtonBarInfo)item.Element;
                            toolStrip.AddToolbarElement(this.CreateButtonBar(buttonBarInfo, previousType, key, toolbarControlList));
                            break;
                        case ToolstripInfo.ElementType.Separator:
                            toolStrip.AddToolbarElement(this.CreateSeparator());
                            break;
                        default:
                            continue;
                    }

                    previousType = item.Type.ToString();
                }

                toolStrip.AddToolbarElement(this.CreatePadding(this.ToolbarHeight, this.ToolstripPadding));
            }

            toolbar.Controls.Add(new LiteralControl(Environment.NewLine));

            return toolbar;
        }

        /// <summary>
        /// method for Create Toolbar Container
        /// </summary>
        /// <returns> returns toolbarInfo</returns>
    [SuppressMessage("Microsoft.Maintainability", "CA1500:UsePropertiesWhereAppropriate", Justification = "Reviewed")]
        protected HtmlGenericControl CreateToolbarContainer()
        {
            HtmlGenericControl toolbarContainer = new HtmlGenericControl("div");
            toolbarContainer.Style["background-color"] = this.ToToolbarColor;

            if (!this.ToolbarDocked)
            {
                toolbarContainer.Style["position"] = "absolute";

                if (this.ToolbarClass.Length > 0)
                {
                    toolbarContainer.Attributes["class"] = this.ToolbarClass;
                }
            }

            return toolbarContainer;
        }

        /// <summary>
        /// method for Create Toolbar Container
        /// </summary>
        /// <param name="toolbarInfoList">parameter toolbarInfoList</param>
        protected void CreateToolbars(ToolbarInfo[] toolbarInfoList)
        {
            this.toolbarContainer = this.CreateToolbarContainer();

            List<Toolbar> toolbars = new List<Toolbar>();
            ToolbarControlList toolbarControlList = new ToolbarControlList();

            for (int i = 0; i < toolbarInfoList.Length; i++)
            {
                bool first = i == 0;
                bool last = toolbarInfoList.Length == i + 1;

                toolbars.Add(this.CreateToolbar(toolbarInfoList[i], toolbarControlList, first, last));
            }

            foreach (Toolbar toolbar in toolbars)
            {
                this.toolbarContainer.Controls.Add(toolbar);
            }

            this.Controls.Add(this.toolbarContainer);
            this.toolbarIDs = this.GetToolbarIDs(toolbars.ToArray());
            this.toolbarData = this.GetToolbarData(toolbarInfoList, toolbarControlList);
        }

        /// <summary>
        /// method for Create Toolbar Information
        /// </summary>
        /// <param name="toolbarInfoList">parameter toolbar Info List</param>
        /// <param name="toolbarControlList">parameter toolbar Control List</param>
        /// <returns> returns toolbarInfo</returns>
    [SuppressMessage("Microsoft.Maintainability", "CA1500:UsePropertiesWhereAppropriate", Justification = "Reviewed")]
        protected string GetToolbarData(ToolbarInfo[] toolbarInfoList, ToolbarControlList toolbarControlList)
        {
            string toolbarData = string.Empty;

            foreach (ToolbarInfo toolbarInfo in toolbarInfoList)
            {
                if (toolbarData.Length > 0)
                {
                    toolbarData += ";";
                }

                toolbarData += toolbarInfo.GetToolbarData(toolbarControlList);
            }

            return toolbarData;
        }

        /// <summary>
        /// The CreateDialogData method
        /// </summary>        
        protected void CreateDialogData()
        {
            List<DialogInfo> dialogs = new List<DialogInfo>();

            string resource = "Winthusiasm.HtmlEditor.Dialogs.Blank.htm";
            string frameUrl = this.GetWebResourceUrl(resource);
            dialogs.Add(new DialogInfo("Blank", frameUrl, " ", 250, 400));

            resource = "Winthusiasm.HtmlEditor.Dialogs.Link.htm";
            frameUrl = this.GetWebResourceUrl(resource);
            dialogs.Add(new DialogInfo("Link", frameUrl, "Hyperlink Properties", 250, 400));

            resource = "Winthusiasm.HtmlEditor.Dialogs.Image.htm";
            frameUrl = this.GetWebResourceUrl(resource);
            dialogs.Add(new DialogInfo("Image", frameUrl, "Image Properties", 250, 400));

            resource = "Winthusiasm.HtmlEditor.Dialogs.Color.htm";
            frameUrl = this.GetWebResourceUrl(resource);
            dialogs.Add(new DialogInfo("ForeColor", frameUrl, "Text Color", 250, 400));
            dialogs.Add(new DialogInfo("BackColor", frameUrl, "Background Color", 250, 400));

            this.OnCreateDialogInfo(new CreateDialogInfoEventArgs(this, dialogs));

            this.dialogData = this.GetDialogData(dialogs);
        }

        /// <summary>
        /// method for Create Toolbar Information
        /// </summary>
        /// <param name="dialogs">parameter dialogs</param>
        /// <returns> returns toolbarInfo</returns>
    [SuppressMessage("Microsoft.Maintainability", "CA1500:UsePropertiesWhereAppropriate", Justification = "Reviewed")]
        protected string GetDialogData(List<DialogInfo> dialogs)
        {
            string dialogData = string.Empty;

            foreach (DialogInfo dialog in dialogs)
            {
                if (dialogData.Length > 0)
                {
                    dialogData += ";";
                }

                dialogData += dialog.GetDialogData();
            }

            return dialogData;
        }

        /// <summary>
        /// method for Create Toolbar Information
        /// </summary>
        /// <param name="id">parameter id</param>
        /// <param name="editor">parameter editor</param>
        /// <param name="editorID">parameter editor ID</param>
        /// <param name="editorScrolling">parameter editor Scrolling</param>
        /// <returns> returns toolbarInfo</returns>
    [SuppressMessage("Microsoft.Maintainability", "CA1500:UsePropertiesWhereAppropriate", Justification = "Reviewed")]
        protected HtmlGenericControl CreateEditorArea(string id, out HtmlGenericControl editor, string editorID, string editorScrolling)
        {
            bool ie6 = this.InternetExplorer && this.BrowserVersion < 7;

            int frameBorderSize = this.EditorBorderSize > 1 ? 1 : 0;
            int areaBorderSize = this.EditorBorderSize - frameBorderSize;
            int areaWidth = this.EditorWidth + (frameBorderSize * 2);
            int areaHeight = this.EditorHeight + (frameBorderSize * 2);
            int editorWidth = ie6 ? this.EditorWidth - (frameBorderSize * 2) : this.EditorWidth;
            int editorHeight = ie6 ? this.EditorHeight - (frameBorderSize * 2) : this.EditorHeight;

            HtmlGenericControl area = new HtmlGenericControl("div");
            area.ID = id;
            area.Style["width"] = areaWidth.ToString() + "px";
            area.Style["height"] = areaHeight.ToString() + "px";
            area.Style["border"] = "solid " + areaBorderSize.ToString() + "px " + this.ToEditorBorderColor;
            area.Style["position"] = "relative";
            area.Style["left"] = "0px";
            area.Style["top"] = "0px";

            string frameTag = this.DesignMode2008 ? "div" : "iframe";

            editor = new HtmlGenericControl(frameTag);
            editor.ID = editorID;
            editor.Style["background-color"] = this.ToEditorBackColor;
            editor.Style["color"] = this.ToEditorForeColor;
            editor.Style["position"] = "absolute";
            editor.Style["left"] = "0px";
            editor.Style["top"] = "0px";

            if (this.DesignMode2008)
            {
                editorWidth += frameBorderSize > 0 ? 2 : 0;
                editorHeight += frameBorderSize > 0 ? 2 : 0;
                editor.Style["width"] = editorWidth.ToString() + "px";
                editor.Style["height"] = editorHeight.ToString() + "px";
            }
            else
            {
                editor.Attributes["width"] = editorWidth.ToString() + "px";
                editor.Attributes["height"] = editorHeight.ToString() + "px";
                editor.Attributes["frameborder"] = "0";
                editor.Attributes["scrolling"] = editorScrolling;
            }

            if (frameBorderSize > 0)
            {
                editor.Style["border"] = "solid " + frameBorderSize.ToString() + "px " + this.ToEditorInnerBorderColor;
            }

            area.Controls.Add(editor);

            return area;
        }

        /// <summary>
        /// method for Create Html Area
        /// </summary>
        /// <returns> returns htmlArea</returns>
        protected HtmlGenericControl CreateHtmlArea()
        {
            this.htmlArea = this.CreateEditorArea("contentText", out this.htmlEditor, "htmlEditor", "no");
            this.htmlArea.Style["display"] = this.InitialMode == Mode.Html ? "block" : "none";

            return this.htmlArea;
        }

        /// <summary>
        /// method for Create Design Area
        /// </summary>
        /// <returns> returns designArea</returns>
        protected HtmlGenericControl CreateDesignArea()
        {
            this.designArea = this.CreateEditorArea("contentHtml", out this.designEditor, "designEditor", "auto");
            this.designArea.Style["display"] = this.InitialMode == Mode.Design ? "block" : "none";

            return this.designArea;
        }

        /// <summary>
        /// The CreateTab method
        /// </summary>
        /// <param name="tabNumber">The tab Number parameter</param>
        /// <param name="name">The name parameter</param>
        /// <param name="toolTip">The tool Tip parameter</param>
        /// <param name="switchMode">The switchMode parameter</param>
        /// <param name="imgName">The image Name parameter</param>
        /// <param name="img">The image parameter</param>
        /// <param name="label">The label parameter</param>
        /// <returns>The System.Web.UI.HtmlControls.HtmlGenericControl type object</returns>                
    [SuppressMessage("Microsoft.Maintainability", "CA1500:UsePropertiesWhereAppropriate", Justification = "Reviewed")]
        protected HtmlGenericControl CreateTab(
            int tabNumber,
            string name,
            string toolTip,
            string switchMode,
            string imgName,
            out HtmlImage img,
            out Label label)
        {
            int tabIndex = tabNumber - 1;
            int tabWidth = this.TabWidth;
            int tabSpacing = 2;
            int tabbarPadding = Math.Max(1, this.EditorBorderSize);
            int leftPosition = tabbarPadding + (tabWidth * tabIndex) + (tabSpacing * tabIndex);
            bool selected = this.InitialMode.ToString() == switchMode;

            HtmlGenericControl tab = new HtmlGenericControl("div");
            tab.Controls.Add(this.CreateRoundedCorner(true, false, this.ToBackColor));
            tab.Controls.Add(this.CreateRoundedCorner(false, false, this.ToBackColor));
            tab.Style["height"] = this.TabHeight.ToString() + "px";
            tab.Style["width"] = tabWidth.ToString() + "px";
            tab.Style["background-color"] = selected ? this.ToSelectedTabBackColor : this.ToTabBackColor;
            tab.Style["color"] = selected ? this.ToSelectedTabTextColor : this.ToTabForeColor;
            tab.Style["cursor"] = "pointer";
            tab.Style["position"] = "absolute";
            tab.Style["left"] = leftPosition.ToString() + "px";
            tab.Style["top"] = "0px";
            tab.Style["font-weight"] = selected ? "bold" : "normal";
            tab.Attributes["title"] = toolTip;
            tab.Attributes["onmouseover"] = this.GetSafeScriptMethod("TabOver(this)");
            tab.Attributes["onmouseout"] = this.GetSafeScriptMethod("TabOut(this)");
            tab.Attributes["onclick"] = this.GetSafeScriptMethod("SwitchMode(this, '" + switchMode + "')");

            img = new HtmlImage();
            string resource = "Winthusiasm.HtmlEditor.Images." + imgName + ".gif";
            img.Src = this.GetEncodedWebResourceUrl(resource);
            img.Attributes["alt"] = this.DesignMode ? string.Empty : toolTip;
            img.Style["float"] = "left";

            tab.Controls.Add(img);

            label = new Label();
            label.Text = name;
            label.Style["float"] = "left";

            tab.Controls.Add(label);

            return tab;
        }

        /// <summary>
        /// The Create Tab bar method
        /// </summary>
        /// <returns>The System.Web.UI.HtmlControls.HtmlGenericControl type object</returns>        
        protected HtmlGenericControl CreateTabbar()
        {
            HtmlGenericControl tabbar = new HtmlGenericControl("div");
            tabbar.Style["width"] = this.Width.ToString();
            tabbar.Style["height"] = this.TabbarHeight.ToString() + "px";
            tabbar.Style["font-family"] = "Verdana";
            tabbar.Style["font-size"] = "8pt";
            tabbar.Style["background-color"] = this.ToTabbarBackColor;
            tabbar.Style["color"] = this.ToTabForeColor;
            tabbar.Style["position"] = "relative";
            tabbar.Style["left"] = "0px";
            tabbar.Style["top"] = "0px";
            tabbar.Style["display"] = this.ToggleMode == ToggleModeType.Tabs ? "block" : "none";

            int tabNumber = 0;

            HtmlImage designImg;
            Label designLabel;

            if (this.DesignModeEditable)
            {
                this.designTab = this.CreateTab(++tabNumber, "Design", "Design Mode", "Design", "design", out designImg, out designLabel);
                this.designTab.ID = "designTab";
                designImg.Style["margin-left"] = this.DesignMode ? "0px" : "2px";
                designImg.Style["margin-top"] = this.DesignMode ? "0px" : "1px";
                designLabel.Style["margin-left"] = "0px";
                designLabel.Style["margin-top"] = "4px";

                tabbar.Controls.Add(this.designTab);
            }

            HtmlImage htmlImg;
            Label htmlLabel;
            string htmlToolTip = this.HtmlModeEditable ? "Html Mode" : "View Html";
            this.htmlTab = this.CreateTab(++tabNumber, "Html", htmlToolTip, "Html", "html", out htmlImg, out htmlLabel);
            this.htmlTab.ID = "htmlTab";
            htmlImg.Style["margin-left"] = this.DesignMode ? "0px" : "4px";
            htmlImg.Style["margin-top"] = this.DesignMode ? "0px" : "1px";
            htmlLabel.Style["margin-left"] = "2px";
            htmlLabel.Style["margin-top"] = "4px";

            tabbar.Controls.Add(this.htmlTab);

            if (!this.DesignModeEditable)
            {
                this.designTab = this.CreateTab(++tabNumber, "View", "View Mode", "Design", "view", out designImg, out designLabel);
                this.designTab.ID = "viewTab";
                designImg.Style["margin-left"] = this.DesignMode ? "0px" : "4px";
                designImg.Style["margin-top"] = this.DesignMode ? "0px" : "1px";
                designLabel.Style["margin-left"] = "2px";
                designLabel.Style["margin-top"] = "4px";

                tabbar.Controls.Add(this.designTab);
            }

            return tabbar;
        }

        /// <summary>
        /// The CreateUpdateArea method
        /// </summary>
        /// <returns>The System.Web.UI.HtmlControls.HtmlGenericControl type object</returns>        
        protected HtmlGenericControl CreateUpdateArea()
        {
            HtmlGenericControl updateArea = new HtmlGenericControl("div");
            updateArea.Style["display"] = "none";

            this.htmlencodedText = new HiddenField();
            this.htmlencodedText.ID = "htmlencodedText";
            this.htmlencodedText.Value = this.ClientEncode(this.htmlText);

            this.modifiedFlag = new HiddenField();
            this.modifiedFlag.ID = "Modified";
            this.modifiedFlag.Value = "false";

            this.saveButton = new Button();
            this.saveButton.ID = "SaveButton";
            this.saveButton.Click += new EventHandler(this.SaveButton_Click);
            this.saveButton.UseSubmitBehavior = false;

            this.updatePanel = new UpdatePanel();
            this.updatePanel.ID = "updatePanel";
            this.updatePanel.UpdateMode = UpdatePanelUpdateMode.Conditional;
            this.updatePanel.RenderMode = UpdatePanelRenderMode.Inline;

            this.updatePanel.ContentTemplateContainer.Controls.Add(this.htmlencodedText);
            this.updatePanel.ContentTemplateContainer.Controls.Add(this.modifiedFlag);
            this.updatePanel.ContentTemplateContainer.Controls.Add(this.saveButton);

            updateArea.Controls.Add(this.updatePanel);

            return updateArea;
        }

        /// <summary>
        /// The CreateAutoSaveValidators method
        /// </summary>
        /// <param name="controls">The controls parameter</param>        
        protected void CreateAutoSaveValidators(ControlCollection controls)
        {
            this.validators = new List<CustomValidator>();

            string[] validationGroups = this.GetAutoSaveValidationGroups();
            string clientValidationFunction = this.FindScriptObject + ".AutoSave";

            foreach (string validationGroup in validationGroups)
            {
                CustomValidator autosaveValidator = new CustomValidator();
                autosaveValidator.ClientValidationFunction = clientValidationFunction;
                autosaveValidator.ValidationGroup = validationGroup;

                controls.Add(autosaveValidator);
                this.validators.Add(autosaveValidator);
            }
        }

        /// <summary>
        /// The GetAutoSaveValidationGroups method
        /// </summary>
        /// <returns>The string[] type object</returns>        
        protected string[] GetAutoSaveValidationGroups()
        {
            if (this.ValidationGroups.Length > 0)
            {
                return this.ValidationGroups;
            }

            List<string> validationGroups = new List<string>();

            if (this.AutoSaveValidationGroups.Length == 0 || this.AutoSaveValidationGroups == ".")
            {
                validationGroups.Add(string.Empty);
            }
            else if (this.AutoSaveValidationGroups == "*")
            {
                validationGroups.Add(string.Empty);

                foreach (IValidator item in this.Page.Validators)
                {
                    BaseValidator validator = item as BaseValidator;
                    if (validator == null)
                    {
                        {
                            continue;
                        }
                    }

                    if (validationGroups.Contains(validator.ValidationGroup))
                    {
                        continue;
                    }

                    validationGroups.Add(validator.ValidationGroup);
                }
            }
            else
            {
                string[] groupNames = this.GetStringList(this.AutoSaveValidationGroups);

                foreach (string groupName in groupNames)
                {
                    string name = groupName == "." ? string.Empty : groupName;

                    if (!validationGroups.Contains(name))
                    {
                        validationGroups.Add(name);
                    }
                }
            }

            this.ValidationGroups = validationGroups.ToArray();

            return this.ValidationGroups;
        }

        /// <summary>
        /// The SetColorScheme method
        /// </summary>        
        protected void SetColorScheme()
        {
            ColorSchemeInfo colorSchemeInfo;

            switch (this.ColorScheme)
            {
                case ColorSchemeType.Custom:
                    colorSchemeInfo = new ColorSchemeInfo(this, this.ColorScheme.ToString());
                    colorSchemeInfo.ReadColors();
                    break;
                case ColorSchemeType.VisualStudio:
                    colorSchemeInfo = new VisualStudioColorSchemeInfo(this, this.ColorScheme.ToString());
                    break;
                case ColorSchemeType.Default:
                    colorSchemeInfo = new ColorSchemeInfo(this, this.ColorScheme.ToString());
                    break;
                default:
                    return;
            }

            this.OnCreateColorSchemeInfo(new CreateColorSchemeInfoEventArgs(colorSchemeInfo));
            colorSchemeInfo.SetColors();
        }

        /// <summary>
        /// The CalculateDimensions method
        /// </summary>
        /// <param name="numToolbars">The number Toolbars parameter</param>        
    [SuppressMessage("Microsoft.Maintainability", "CA1500:UsePropertiesWhereAppropriate", Justification = "Reviewed")]
        protected void CalculateDimensions(int numToolbars)
        {
            int w = (int)this.Width.Value;
            int h = (int)this.Height.Value;
            int tabbarHeight = this.ToggleMode == ToggleModeType.Tabs ? this.TabbarHeight : 0;
            int toolbarHeight = this.ToolbarDocked && numToolbars > 0 ? (this.ToolbarHeight * numToolbars) + (this.ToolbarPadding + this.AdditionalToolbarPadding) + (numToolbars - 1) : 0;
            this.EditorWidth = w - (this.EditorBorderSize * 2);
            this.EditorHeight = h - (this.EditorBorderSize * 2) - toolbarHeight - tabbarHeight;
        }

        /// <summary>
        /// The CreateChildControls method
        /// </summary>        
        protected override void CreateChildControls()
        {
            this.SetColorScheme();

            this.CreateDialogData();
            ToolbarInfo[] toolbarInfoList = this.CreateToolbarInfoList();

            this.CalculateDimensions(toolbarInfoList.Length);

            this.CreateDialogBox();
            this.CreateToolbars(toolbarInfoList);

            if (!this.DesignMode)
            {
                this.Controls.Add(this.CreateHtmlArea());
            }

            this.Controls.Add(this.CreateDesignArea());
            this.Controls.Add(this.CreateTabbar());
            this.Controls.Add(this.CreateUpdateArea());

            if (this.AutoSave)
            {
                this.CreateAutoSaveValidators(this.Controls);
            }

            base.CreateChildControls();
        }

        /// <summary>
        /// The OnPreRender method
        /// </summary>
        /// <param name="e">The e parameter</param>        
        protected override void OnPreRender(EventArgs e)
        {
            SaveButtonInfo.AttachButtons(this, this.GetStringList(this.SaveButtons));

            if (!this.DesignMode)
            {
                // Test for ScriptManager and register if it exists.
                this.sm = ScriptManager.GetCurrent(this.Page);

                if (this.sm == null)
                {
                    throw new HttpException("A ScriptManager control must exist on the current page.");
                }

                this.sm.RegisterScriptControl(this);

                // If updatePanel was manually updated, register a dataitem.
                if (this.sm.IsInAsyncPostBack && this.updateHtml)
                {
                    this.sm.RegisterDataItem(this.htmlencodedText, "Updated");
                }
            }

            base.OnPreRender(e);
        }

        /// <summary>
        /// The GetToolbarIDs method
        /// </summary>
        /// <param name="toolbars">The toolbars parameter</param>
        /// <returns>The string type object</returns>        
    [SuppressMessage("Microsoft.Maintainability", "CA1500:UsePropertiesWhereAppropriate", Justification = "Reviewed")]
        protected string GetToolbarIDs(Toolbar[] toolbars)
        {
            string toolbarIDs = string.Empty;
            foreach (Toolbar toolbar in toolbars)
            {
                if (toolbarIDs.Length > 0)
                {
                    toolbarIDs += ",";
                }

                toolbarIDs += toolbar.ClientID;
            }

            return toolbarIDs;
        }

        /// <summary>
        /// The GetDialogColors method
        /// </summary>
        /// <returns>The string type object</returns>        
        protected string GetDialogColors()
        {
            string dialogColors = this.ToDialogBackColor;
            dialogColors += ";" + this.ToDialogForeColor;
            dialogColors += ";" + this.ToDialogHeadingColor;
            dialogColors += ";" + this.ToDialogHeadingTextColor;
            dialogColors += ";" + this.ToDialogButtonBarColor;
            dialogColors += ";" + this.ToDialogBorderColor;
            dialogColors += ";" + ColorTranslator.ToHtml(this.DialogTableColor);
            dialogColors += ";" + ColorTranslator.ToHtml(this.DialogTabTextColor);
            dialogColors += ";" + ColorTranslator.ToHtml(this.DialogSelectedTabTextColor);
            dialogColors += ";" + ColorTranslator.ToHtml(this.DialogSelectedTabColor);
            dialogColors += ";" + ColorTranslator.ToHtml(this.DialogUnselectedTabColor);

            return dialogColors;
        }

        /// <summary>
        /// The GetDialogDimensions method
        /// </summary>
        /// <returns>The string type object</returns>        
        protected string GetDialogDimensions()
        {
            return this.DialogHeadingHeight.ToString() + ";" + this.DialogButtonBarHeight.ToString();
        }

        /// <summary>
        /// The GetValidatorIDs method
        /// </summary>
        /// <returns>type object</returns>        
        protected List<string> GetValidatorIDs()
        {
            List<string> validatorIDs = new List<string>();

            foreach (CustomValidator validator in this.validators)
            {
                validatorIDs.Add(validator.ClientID);
            }

            return validatorIDs;
        }

        /// <summary>
        /// The Render method
        /// </summary>
        /// <param name="writer">The writer parameter</param>        
        protected override void Render(HtmlTextWriter writer)
        {
            if (!this.DesignMode)
            {
                this.sm.RegisterScriptDescriptors(this);
            }

            base.Render(writer);
        }

        /// <summary>
        /// The GetScriptReferences method
        /// </summary>
        /// <returns>type object</returns>        
        protected virtual IEnumerable<ScriptReference> GetScriptReferences()
        {
            ScriptReference htmlEditorReference = new ScriptReference("Winthusiasm.HtmlEditor.Scripts.HtmlEditor.js", "Winthusiasm.HtmlEditor");
            ScriptReference dialogBehaviorReference = new ScriptReference("Winthusiasm.HtmlEditor.Scripts.DialogBehavior.js", "Winthusiasm.HtmlEditor");

            return new ScriptReference[] { htmlEditorReference, dialogBehaviorReference };
        }

        /// <summary>
        /// The GetScriptDescriptors method
        /// </summary>
        /// <returns> type object</returns>        
        protected virtual IEnumerable<ScriptDescriptor> GetScriptDescriptors()
        {
            ScriptControlDescriptor descriptor = new ScriptControlDescriptor("Winthusiasm.HtmlEditor.HtmlEditor", this.ClientID);
            descriptor.AddProperty("htmlencodedTextID", this.htmlencodedText.ClientID);
            descriptor.AddProperty("modifiedID", this.modifiedFlag.ClientID);
            descriptor.AddProperty("htmlEditorID", this.htmlEditor.ClientID);
            descriptor.AddProperty("designEditorID", this.designEditor.ClientID);
            descriptor.AddProperty("htmlAreaID", this.htmlArea.ClientID);
            descriptor.AddProperty("designAreaID", this.designArea.ClientID);
            descriptor.AddProperty("htmlTabID", this.htmlTab.ClientID);
            descriptor.AddProperty("designTabID", this.designTab.ClientID);
            descriptor.AddProperty("dialogBoxIDs", this.dialogBoxIDs);
            descriptor.AddProperty("saveButtonID", this.saveButton.ClientID);
            descriptor.AddProperty("toolbarIDs", this.toolbarIDs);
            descriptor.AddProperty("editorForeColor", ColorTranslator.ToHtml(this.EditorForeColor));
            descriptor.AddProperty("editorBackColor", ColorTranslator.ToHtml(this.EditorBackColor));
            descriptor.AddProperty("toolbarColor", ColorTranslator.ToHtml(this.ToolbarColor));
            descriptor.AddProperty("tabForeColor", ColorTranslator.ToHtml(this.TabForeColor));
            descriptor.AddProperty("tabBackColor", ColorTranslator.ToHtml(this.TabBackColor));
            descriptor.AddProperty("selectedTabBackColor", ColorTranslator.ToHtml(this.SelectedTabBackColor));
            descriptor.AddProperty("selectedTabTextColor", ColorTranslator.ToHtml(this.SelectedTabTextColor));
            descriptor.AddProperty("tabMouseOverColor", ColorTranslator.ToHtml(this.TabMouseOverColor));
            descriptor.AddProperty("tabbarBackColor", ColorTranslator.ToHtml(this.TabbarBackColor));
            descriptor.AddProperty("buttonMouseOverColor", ColorTranslator.ToHtml(this.ButtonMouseOverColor));
            descriptor.AddProperty("buttonMouseOverBorderColor", ColorTranslator.ToHtml(this.ButtonMouseOverBorderColor));
            descriptor.AddProperty("dialogColors", this.GetDialogColors());
            descriptor.AddProperty("outputXHTML", this.OutputXHTML);
            descriptor.AddProperty("convertDeprecatedSyntax", this.ConvertDeprecatedSyntax);
            descriptor.AddProperty("convertParagraphs", this.ConvertParagraphs);
            descriptor.AddProperty("replaceNoBreakSpace", this.ReplaceNoBreakSpace);
            descriptor.AddProperty("showModifiedAsterick", this.ShowModifiedAsterick);
            descriptor.AddProperty("toolbarData", this.toolbarData);
            descriptor.AddProperty("dialogData", this.dialogData);
            descriptor.AddProperty("dialogDimensions", this.GetDialogDimensions());
            descriptor.AddProperty("pixelImageUrl", this.PixelImageUrl);
            descriptor.AddProperty("allowedTags", this.AllowedTags);
            descriptor.AddProperty("allowedAttributes", this.AllowedAttributes);
            descriptor.AddProperty("noScriptAttributes", this.NoScriptAttributes);
            descriptor.AddProperty("formatHtmlMode", this.FormatHtmlMode);
            descriptor.AddProperty("newLine", Environment.NewLine);
            descriptor.AddProperty("initialMode", this.InitialMode.ToString());
            descriptor.AddProperty("designModeEditable", this.DesignModeEditable);
            descriptor.AddProperty("htmlModeEditable", this.HtmlModeEditable);
            descriptor.AddProperty("designModeCss", this.GetDesignModeCss());
            descriptor.AddProperty("designModeEmulateIE7", this.DesignModeEmulateIE7);
            descriptor.AddProperty("textDirection", this.TextDirection.ToString());
            descriptor.AddProperty("version", typeof(Winthusiasm.HtmlEditor.HtmlEditor).Assembly.GetName().Version.ToString());

            if (this.validators != null)
            {
                descriptor.AddProperty("validatorIDs", this.GetValidatorIDs());
            }

            if (!string.IsNullOrEmpty(this.ModifiedChanged))
            {
                {
                    descriptor.AddEvent("modifiedChanged", this.ModifiedChanged);
                }
            }

            if (!string.IsNullOrEmpty(this.ContextChanged))
            {
                descriptor.AddEvent("contextChanged", this.ContextChanged);
            }

            return new ScriptDescriptor[] { descriptor };
        }

        /// <summary>
        /// The OnCreateColorSchemeInfo method
        /// </summary>
        /// <param name="e">The e parameter</param>        
        protected virtual void OnCreateColorSchemeInfo(CreateColorSchemeInfoEventArgs e)
        {
            CreateColorSchemeInfoEventHandler handler = (CreateColorSchemeInfoEventHandler)Events[CreateColorSchemeInfoEventKey];
            if (handler != null)
            {
                handler(this, e);
            }
        }

        /// <summary>
        /// The OnCreateToolbarInfo method
        /// </summary>
        /// <param name="e">The e parameter</param>        
        protected virtual void OnCreateToolbarInfo(CreateToolbarInfoEventArgs e)
        {
            CreateToolbarInfoEventHandler handler = (CreateToolbarInfoEventHandler)Events[CreateToolbarInfoEventKey];
            if (handler != null)
            {
                handler(this, e);
            }
        }

        /// <summary>
        /// The OnCreateDialogInfo method
        /// </summary>
        /// <param name="e">The e parameter</param>        
        protected virtual void OnCreateDialogInfo(CreateDialogInfoEventArgs e)
        {
            CreateDialogInfoEventHandler handler = (CreateDialogInfoEventHandler)Events[CreateDialogInfoEventKey];
            if (handler != null)
            {
                handler(this, e);
            }
        }

        /// <summary>
        /// The OnSave method
        /// </summary>
        /// <param name="e">The e parameter</param>        
        protected virtual void OnSave(SaveEventArgs e)
        {
            SaveEventHandler handler = (SaveEventHandler)Events[SaveEventKey];
            if (handler != null)
            {
                handler(this, e);
            }
        }

        /// <summary>
        /// The SaveEventArgs class
        /// </summary>        
        public sealed class SaveEventArgs : EventArgs
        {
            /// <summary>
            /// The editor field
            /// </summary>            
            private HtmlEditor editor;

            /// <summary>
            /// Initializes a new instance of the <see cref="SaveEventArgs" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>            
            public SaveEventArgs(HtmlEditor editor)
            {
                this.editor = editor;
            }

            /// <summary>
            /// Gets the Text property
            /// </summary>            
            public string Text
            {
                get { return this.editor.Text; }
            }
        }

        #endregion

        #region Toolbar Classes

        /// <summary>
        /// The ToolbarElement class
        /// </summary>        
        public abstract class ToolbarElement
        {
            /// <summary>
            /// The name field
            /// </summary>            
            private string name;
            
            /// <summary>
            /// The enabled field
            /// </summary>            
            private EnabledType enabled;
            
            /// <summary>
            /// The dependency field
            /// </summary>            
            private DependencyType dependency;
            
            /// <summary>
            /// The disableMethod field
            /// </summary>            
            private DisableMethodType disableMethod;

            /// <summary>
            /// Initializes a new instance of the <see cref="ToolbarElement" /> class.
            /// </summary>
            /// <param name="name">The name parameter</param>            
            public ToolbarElement(string name)
            {
                this.name = name;
                this.enabled = EnabledType.Always;
                this.dependency = DependencyType.None;
                this.disableMethod = DisableMethodType.Opacity;
            }

            /// <summary>
            /// The DisableMethodType enumeration
            /// </summary>            
            public enum DisableMethodType
            {
                /// <summary>
                /// Represents opacity
                /// </summary>
                Opacity,

                /// <summary>
                /// Represents hide
                /// </summary>
                Hide
            }

            /// <summary>
            /// The EnabledType enumeration
            /// </summary>            
            public enum EnabledType
            {
                /// <summary>
                /// Represents design
                /// </summary>
                Design,

                /// <summary>
                /// Represents html
                /// </summary>
                Html,

                /// <summary>
                /// Represents always
                /// </summary>
                Always,

                /// <summary>
                /// Represents never
                /// </summary>
                Never
            }

            /// <summary>
            /// The DependencyType enumeration
            /// </summary>            
            public enum DependencyType
            {
                /// <summary>
                /// Represents editable
                /// </summary>
                Editable,

                /// <summary>
                /// Represents none
                /// </summary>
                None
            }

            /// <summary>
            /// Gets the Name property
            /// </summary>            
            public string Name
            {
                get { return this.name; }
            }

            /// <summary>
            /// Gets or sets the Enabled property
            /// </summary>            
            public EnabledType Enabled
            {
                get { return this.enabled; }
                set { this.enabled = value; }
            }
            
            /// <summary>
            /// Gets or sets the Dependency property
            /// </summary>            
            public DependencyType Dependency
            {
                get { return this.dependency; }
                set { this.dependency = value; }
            }

            /// <summary>
            /// Gets or sets the DisableMethod property
            /// </summary>            
            public DisableMethodType DisableMethod
            {
                get { return this.disableMethod; }
                set { this.disableMethod = value; }
            }
        }

        /// <summary>
        /// The SelectInfo class
        /// </summary>        
        public class SelectInfo : ToolbarElement
        {
            /// <summary>
            /// The items field
            /// </summary>            
            private SelectList items;
            
            /// <summary>
            /// The onChange field
            /// </summary>            
            private string onchange;

            /// <summary>
            /// Initializes a new instance of the <see cref="SelectInfo" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="name">The name parameter</param>
            /// <param name="items">The items parameter</param>
            /// <param name="onchange">The onChange parameter</param>
            /// <param name="externalMethod">The externalMethod parameter</param>            
            public SelectInfo(HtmlEditor editor, string name, SelectList items, string onchange, bool externalMethod)
                : base(name)
            {
                this.items = items;
                this.onchange = externalMethod ? onchange : editor.GetSafeScriptMethod(onchange + "(this.options[this.selectedIndex].value)");
                this.Enabled = EnabledType.Design;
                this.Dependency = DependencyType.Editable;
            }            

            /// <summary>
            /// Gets the Items property
            /// </summary>            
            public SelectList Items
            {
                get { return this.items; }
            }

            /// <summary>
            /// Gets the OnChange property
            /// </summary>            
            public string OnChange
            {
                get { return this.onchange; }
            }

            /// <summary>
            /// The SelectList class
            /// </summary>            
            public class SelectList : Dictionary<string, string>
            {
            }
        }

        /// <summary>
        /// The ButtonInfo class
        /// </summary>        
        public class ButtonInfo : ToolbarElement
        {
            /// <summary>
            /// The image field
            /// </summary>            
            private string imageSrc;
            
            /// <summary>
            /// The toolTip field
            /// </summary>            
            private string toolTip;
            
            /// <summary>
            /// The onMouseOver field
            /// </summary>            
            private string onmouseOver;
            
            /// <summary>
            /// The onMouseOut field
            /// </summary>            
            private string onmouseOut;
            
            /// <summary>
            /// The onClick field
            /// </summary>            
            private string onclick;

            /// <summary>
            /// Initializes a new instance of the <see cref="ButtonInfo" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="name">The name parameter</param>
            /// <param name="toolTip">The toolTip parameter</param>            
            public ButtonInfo(HtmlEditor editor, string name, string toolTip)
                : base(name)
            {
                string resource = "Winthusiasm.HtmlEditor.Images." + name.ToLowerInvariant() + ".gif";
                this.imageSrc = editor.GetEncodedWebResourceUrl(resource);
                this.toolTip = toolTip;
                this.onmouseOver = editor.GetSafeScriptMethod("MouseOver(this)");
                this.onmouseOut = editor.GetSafeScriptMethod("MouseOut(this)");

                bool hasDialog = editor.HasDialog(name);
                string method = hasDialog ? "DialogBox('" + name + "')" : "Do" + name + "()";
                this.onclick = editor.GetSafeScriptMethod(method);

                this.Enabled = EnabledType.Design;
                this.Dependency = DependencyType.Editable;
            }

            /// <summary>
            /// Initializes a new instance of the <see cref="ButtonInfo" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="name">The name parameter</param>
            /// <param name="imageSrc">The image parameter</param>
            /// <param name="toolTip">The tool Tip parameter</param>
            /// <param name="onclick">The on Click parameter</param>
            /// <param name="externalMethod">The externalMethod parameter</param>            
            public ButtonInfo(HtmlEditor editor, string name, string imageSrc, string toolTip, string onclick, bool externalMethod)
                : base(name)
            {
                this.imageSrc = imageSrc;
                this.toolTip = toolTip;
                this.onmouseOver = editor.GetSafeScriptMethod("MouseOver(this)");
                this.onmouseOut = editor.GetSafeScriptMethod("MouseOut(this)");
                this.onclick = externalMethod ? onclick : editor.GetSafeScriptMethod(onclick);
            }

            /// <summary>
            /// Gets the Image property
            /// </summary>            
            public string ImageSrc
            {
                get { return this.imageSrc; }
            }

            /// <summary>
            /// Gets the ToolTip property
            /// </summary>            
            public string ToolTip
            {
                get { return this.toolTip; }
            }

            /// <summary>
            /// Gets the OnMouseOver property
            /// </summary>            
            public string OnMouseOver
            {
                get { return this.onmouseOver; }
            }

            /// <summary>
            /// Gets the OnMouseOut property
            /// </summary>            
            public string OnMouseOut
            {
                get { return this.onmouseOut; }
            }

            /// <summary>
            /// Gets the OnClick property
            /// </summary>            
            public string OnClick
            {
                get { return this.onclick; }
            }
        }

        /// <summary>
        /// The ButtonBarInfo class
        /// </summary>        
        public class ButtonBarInfo : ToolbarElement
        {
            /// <summary>
            /// The buttons field
            /// </summary>            
            private List<ButtonInfo> buttons;

            /// <summary>
            /// Initializes a new instance of the <see cref="ButtonBarInfo" /> class.
            /// </summary>
            /// <param name="name">The name parameter</param>
            /// <param name="buttons">The buttons parameter</param>            
            public ButtonBarInfo(string name, List<ButtonInfo> buttons)
                : base(name)
            {
                this.buttons = buttons;
            }

            /// <summary>
            /// Gets the Buttons property
            /// </summary>            
            public List<ButtonInfo> Buttons
            {
                get { return this.buttons; }
            }
        }

        /// <summary>
        /// The SeparatorInfo class
        /// </summary>        
        public class SeparatorInfo : ToolbarElement
        {
            /// <summary>
            /// Initializes a new instance of the <see cref="SeparatorInfo" /> class.
            /// </summary>            
            public SeparatorInfo()
                : base("Separator")
            {
            }
        }

        /// <summary>
        /// The Tool strip class
        /// </summary>        
        public class ToolstripInfo : ToolbarElement
        {
            /// <summary>
            /// The items field
            /// </summary>            
            private List<ToolstripItemInfo> items = new List<ToolstripItemInfo>();

            /// <summary>
            /// Initializes a new instance of the <see cref="ToolstripInfo" /> class.
            /// </summary>            
            public ToolstripInfo()
                : base("Toolstrip")
            {
            }

            /// <summary>
            /// The ElementType enumeration
            /// </summary>            
            public enum ElementType
            {
                /// <summary>
                /// Represents select
                /// </summary>
                Select,

                /// <summary>
                /// Represents buttons
                /// </summary>
                Buttons,

                /// <summary>
                /// Represents separator
                /// </summary>
                Separator
            }

            /// <summary>
            /// Gets the Items property
            /// </summary>            
            public List<ToolstripItemInfo> Items
            {
                get { return this.items; }
            }

            /// <summary>
            /// The Tool strip Item class
            /// </summary>            
            public class ToolstripItemInfo
            {
                /// <summary>
                /// The type field
                /// </summary>                
                private ElementType type;
                
                /// <summary>
                /// The element field
                /// </summary>                
                private ToolbarElement element;

                /// <summary>
                /// Initializes a new instance of the <see cref="ToolstripItemInfo" /> class.
                /// </summary>
                /// <param name="type">The type parameter</param>
                /// <param name="element">The element parameter</param>                
                public ToolstripItemInfo(ElementType type, ToolbarElement element)
                {
                    this.type = type;
                    this.element = element;
                }

                /// <summary>
                /// Gets the Type property
                /// </summary>                
                public ElementType Type
                {
                    get { return this.type; }
                }

                /// <summary>
                /// Gets the Element property
                /// </summary>                
                public ToolbarElement Element
                {
                    get { return this.element; }
                }
            }
        }

        /// <summary>
        /// The ToolbarInfo class
        /// </summary>        
        public class ToolbarInfo : ToolbarElement
        {
            /// <summary>
            /// The tool strips field
            /// </summary>            
            private List<ToolstripInfo> toolstrips = new List<ToolstripInfo>();
            
            /// <summary>
            /// The deleted field
            /// </summary>            
            private bool deleted = false;
            
            /// <summary>
            /// Initializes a new instance of the <see cref="ToolbarInfo" /> class.
            /// </summary>
            /// <param name="name">The name parameter</param>            
            public ToolbarInfo(string name)
                : base(name)
            {
            }

            /// <summary>
            /// Gets the Tool strips property
            /// </summary>            
            public List<ToolstripInfo> Toolstrips
            {
                get { return this.toolstrips; }
            }

            /// <summary>
            /// Gets a value indicating whether deleted
            /// </summary>            
            public bool Deleted
            {
                get { return this.deleted; }
            }

            /// <summary>
            /// The Delete method
            /// </summary>            
            public void Delete()
            {
                this.deleted = true;
            }

            /// <summary>
            /// The FindElement method
            /// </summary>
            /// <param name="name">The name parameter</param>
            /// <returns>Toolbar Element type object</returns>            
            public ToolbarElement FindElement(string name)
            {
                foreach (HtmlEditor.ToolstripInfo toolstripInfo in this.Toolstrips)
                {
                    foreach (HtmlEditor.ToolstripInfo.ToolstripItemInfo item in toolstripInfo.Items)
                    {
                        if (item.Element.Name == name)
                        {
                            return item.Element;
                        }

                        if (item.Type == ToolstripInfo.ElementType.Buttons)
                        {
                            ButtonBarInfo buttonbarInfo = (ButtonBarInfo)item.Element;
                            foreach (ButtonInfo buttonInfo in buttonbarInfo.Buttons)
                            {
                                if (buttonInfo.Name == name)
                                {
                                    return buttonInfo;
                                }
                            }
                        }
                    }
                }

                return null;
            }

            /// <summary>
            /// The GetToolbarData method
            /// </summary>
            /// <param name="toolbarControlList">The toolbarControlList parameter</param>
            /// <returns>The string type object</returns>            
            public string GetToolbarData(ToolbarControlList toolbarControlList)
            {
                string key = Name;
                string toolbarData = this.GetToolbarElementData(this, key, toolbarControlList);
                string previousType = "None";

                foreach (ToolstripInfo toolstripInfo in this.Toolstrips)
                {
                    foreach (ToolstripInfo.ToolstripItemInfo item in toolstripInfo.Items)
                    {
                        switch (item.Type)
                        {
                            case ToolstripInfo.ElementType.Select:
                                SelectInfo selectInfo = (SelectInfo)item.Element;
                                toolbarData += this.GetSelectData(selectInfo, previousType, key, toolbarControlList);
                                previousType = "Select";
                                break;
                            case ToolstripInfo.ElementType.Buttons:
                                ButtonBarInfo buttonBarInfo = (ButtonBarInfo)item.Element;
                                toolbarData += this.GetButtonBarData(buttonBarInfo, previousType, key, toolbarControlList);
                                previousType = "Buttons";
                                break;
                            default:
                                continue;
                        }
                    }
                }
                
                return toolbarData;
            }

            /// <summary>
            /// The GetSelectData method
            /// </summary>
            /// <param name="selectInfo">The selectInfo parameter</param>
            /// <param name="previousType">The previousType parameter</param>
            /// <param name="baseKey">The baseKey parameter</param>
            /// <param name="toolbarControlList">The toolbarControlList parameter</param>
            /// <returns>The string type object</returns>            
            protected string GetSelectData(SelectInfo selectInfo, string previousType, string baseKey, ToolbarControlList toolbarControlList)
            {
                string key = baseKey + "." + selectInfo.Name;
                string selectData = previousType == "None" ? "$" : "|";
                selectData += "Select?" + this.GetToolbarElementData(selectInfo, key, toolbarControlList);

                return selectData;
            }

            /// <summary>
            /// The GetButtonBarData method
            /// </summary>
            /// <param name="buttonBarInfo">The buttonBarInfo parameter</param>
            /// <param name="previousType">The previousType parameter</param>
            /// <param name="baseKey">The baseKey parameter</param>
            /// <param name="toolbarControlList">The toolbarControlList parameter</param>
            /// <returns>The string type object</returns>            
            protected string GetButtonBarData(ButtonBarInfo buttonBarInfo, string previousType, string baseKey, ToolbarControlList toolbarControlList)
            {
                string key = baseKey + "." + buttonBarInfo.Name;
                string buttonBarData = previousType == "None" ? "$" : "|";
                buttonBarData += "Buttons?" + this.GetToolbarElementData(buttonBarInfo, key, toolbarControlList);
                
                string previousButtonBarType = "None";
                
                foreach (ButtonInfo buttonInfo in buttonBarInfo.Buttons)
                {
                    buttonBarData += this.GetButtonData(buttonInfo, previousButtonBarType, key, toolbarControlList);
                    previousButtonBarType = "Button";
                }

                return buttonBarData;
            }

            /// <summary>
            /// The GetButtonData method
            /// </summary>
            /// <param name="buttonInfo">The buttonInfo parameter</param>
            /// <param name="previousButtonBarType">The previousButtonBarType parameter</param>
            /// <param name="baseKey">The baseKey parameter</param>
            /// <param name="toolbarControlList">The toolbarControlList parameter</param>
            /// <returns>The string type object</returns>            
            protected string GetButtonData(ButtonInfo buttonInfo, string previousButtonBarType, string baseKey, ToolbarControlList toolbarControlList)
            {
                string key = baseKey + "." + buttonInfo.Name;
                string buttonData = previousButtonBarType == "None" ? "=" : ",";
                buttonData += this.GetToolbarElementData(buttonInfo, key, toolbarControlList);

                return buttonData;
            }

            /// <summary>
            /// The GetToolbarElementData method
            /// </summary>
            /// <param name="toolbarElement">The toolbarElement parameter</param>
            /// <param name="key">The key parameter</param>
            /// <param name="toolbarControlList">The toolbarControlList parameter</param>
            /// <returns>The string type object</returns>            
            protected string GetToolbarElementData(ToolbarElement toolbarElement, string key, ToolbarControlList toolbarControlList)
            {
                return toolbarElement.Name + "@" + toolbarElement.Enabled.ToString() + "#" + toolbarElement.Dependency.ToString() + "#" + toolbarElement.DisableMethod.ToString() + "#" + toolbarControlList[key].ClientID;
            }
        }

        /// <summary>
        /// The Tool strip Data class
        /// </summary>        
        public class ToolstripData
        {
            /// <summary>
            /// The items field
            /// </summary>            
            private List<ToolstripItemData> items = new List<ToolstripItemData>();

            /// <summary>
            /// The Tool strip Item Type enumeration
            /// </summary>            
            public enum ToolstripItemType
            {
                /// <summary>
                /// Represents separator
                /// </summary>
                Separator,

                /// <summary>
                /// Represents button
                /// </summary>
                Button,

                /// <summary>
                /// Represents select
                /// </summary>
                Select
            }

            /// <summary>
            /// Gets the Items property
            /// </summary>            
            public List<ToolstripItemData> Items
            {
                get { return this.items; }
            }
            
            /// <summary>
            /// The GetButtonNames method
            /// </summary>
            /// <param name="toolstripDataList">The tool strip Data List parameter</param>
            /// <returns>type object</returns>            
            public static List<string> GetButtonNames(List<ToolstripData> toolstripDataList)
            {
                List<string> buttonNames = new List<string>();

                foreach (ToolstripData toolstripData in toolstripDataList)
                {
                    foreach (ToolstripData.ToolstripItemData item in toolstripData.Items)
                    {
                        if (item.Type == ToolstripItemType.Button)
                        {
                            buttonNames.Add(item.Name);
                        }
                    }
                }

                return buttonNames;
            }
        
            /// <summary>
            /// The Create Tool strip Data method
            /// </summary>
            /// <param name="toolbarElements">The tool bar Elements parameter</param>
            /// <returns>type object</returns>            
            public static List<ToolstripData> CreateToolstripData(string toolbarElements)
            {
                List<ToolstripData> toolstripDataList = new List<ToolstripData>();

                string[] toolstrips = toolbarElements.Split(':');

                foreach (string toolstrip in toolstrips)
                {
                    string strip = toolstrip.Trim();
                    if (strip.Length == 0)
                    {
                        continue;
                    }

                    ToolstripData toolstripData = new ToolstripData();

                    string[] separators = strip.Split('|');

                    for (int i = 0; i < separators.Length; i++)
                    {
                        string separateElements = separators[i].Trim();
                        if (separateElements.Length == 0)
                        {
                            continue;
                        }

                        if (i > 0)
                        {
                            toolstripData.Items.Add(new ToolstripItemData(ToolstripItemType.Separator, string.Empty));
                        }

                        string[] elements = separateElements.Split(',');

                        foreach (string element in elements)
                        {
                            if (element.Trim().Length == 0)
                            {
                                continue;
                            }

                            string[] elementInfo = element.Split('#');
                            string type = "Button";
                            string name = elementInfo[0].Trim();

                            if (elementInfo.Length > 2)
                            {
                                throw new HttpException(string.Format("Invalid toolbar element: {0}", element));
                            }
                            else if (elementInfo.Length == 2)
                            {
                                type = name;
                                name = elementInfo[1].Trim();
                            }

                            ToolstripItemType toolstripItemType;

                            switch (type)
                            {
                                case "Button":
                                    toolstripItemType = ToolstripItemType.Button;
                                    break;
                                case "Select":
                                    toolstripItemType = ToolstripItemType.Select;
                                    break;
                                default:
                                    throw new HttpException(string.Format("Invalid toolbar element type: {0}", type));
                            }

                            toolstripData.Items.Add(new ToolstripItemData(toolstripItemType, name));
                        }
                    }

                    if (toolstripData.Items.Count > 0)
                    {
                        toolstripDataList.Add(toolstripData);
                    }
                }

                return toolstripDataList;
            }
            
            /// <summary>
            /// The Tool strip Item Data class
            /// </summary>            
            public class ToolstripItemData
            {
                /// <summary>
                /// The type field
                /// </summary>                
                private ToolstripItemType type;
                
                /// <summary>
                /// The name field
                /// </summary>                
                private string name;

                /// <summary>
                /// Initializes a new instance of the <see cref="ToolstripItemData" /> class.
                /// </summary>
                /// <param name="type">The type parameter</param>
                /// <param name="name">The name parameter</param>                
                public ToolstripItemData(ToolstripItemType type, string name)
                {
                    this.type = type;
                    this.name = name;
                }

                /// <summary>
                /// Gets the Type property
                /// </summary>                
                public ToolstripItemType Type
                {
                    get { return this.type; }
                }

                /// <summary>
                /// Gets the Name property
                /// </summary>                
                public string Name
                {
                    get { return this.name; }
                }                
            }
        }

        /// <summary>
        /// The Tool strip class
        /// </summary>        
        public class Toolstrip : HtmlGenericControl
        {
            /// <summary>
            /// The tool strip Body field
            /// </summary>            
            private HtmlGenericControl toolstripBody;

            /// <summary>
            /// Initializes a new instance of the <see cref="Toolstrip" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>            
            public Toolstrip(HtmlEditor editor)
                : base("div")
            {
                int height = editor.ToolbarHeight;
                
                this.Style["display"] = "inline";
                this.Style["height"] = height.ToString() + "px";
                this.Style["background-color"] = editor.ToToolbarColor;

                string floatStyle = editor.DesignMode2008 ? "none" : "left";

                HtmlGenericControl toolstripBegin = new HtmlGenericControl("div");
                toolstripBegin.Style["float"] = floatStyle;
                toolstripBegin.Style["display"] = "inline";
                toolstripBegin.Style["width"] = "2px";
                toolstripBegin.Style["height"] = height.ToString() + "px";
                this.SetBackgroundImage(editor, toolstripBegin, SectionType.Begin, editor.DesignMode2008);

                this.toolstripBody = new HtmlGenericControl("div");
                this.toolstripBody.Style["float"] = floatStyle;
                this.toolstripBody.Style["display"] = "inline";
                this.toolstripBody.Style["height"] = height.ToString() + "px";
                this.SetBackgroundImage(editor, this.toolstripBody, SectionType.Body, false);

                HtmlGenericControl toolstripEnd = new HtmlGenericControl("div");
                toolstripEnd.Style["float"] = floatStyle;
                toolstripEnd.Style["display"] = "inline";
                toolstripEnd.Style["width"] = "2px";
                toolstripEnd.Style["height"] = height.ToString() + "px";
                this.SetBackgroundImage(editor, toolstripEnd, SectionType.End, editor.DesignMode2008);

                this.Controls.Add(toolstripBegin);
                this.Controls.Add(this.toolstripBody);
                this.Controls.Add(toolstripEnd);
            }

            /// <summary>
            /// The Section Type enumeration
            /// </summary>            
            protected enum SectionType
            {
                /// <summary>
                /// Represents begin.
                /// </summary>
                Begin,

                /// <summary>
                /// Represents body.
                /// </summary>
                Body,

                /// <summary>
                /// Represents end
                /// </summary>
                End
            }

            /// <summary>
            /// The AddToolbarElement method
            /// </summary>
            /// <param name="toolbarElement">The toolbarElement parameter</param>            
            public void AddToolbarElement(Control toolbarElement)
            {
                this.toolstripBody.Controls.Add(toolbarElement);
            }

            /// <summary>
            /// The SetBackgroundImage method
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="toolstripSection">The tool strip Section parameter</param>
            /// <param name="sectionType">The sectionType parameter</param>
            /// <param name="designerImplementation">The designerImplementation parameter</param>            
            protected void SetBackgroundImage(HtmlEditor editor, HtmlGenericControl toolstripSection, SectionType sectionType, bool designerImplementation)
            {
                if (editor.NoToolstripBackgroundImage)
                {
                    return;
                }

                string imageSrc;

                switch (editor.ToolstripBackgroundImage)
                {
                    case ToolstripBackgroundImageType.Custom:
                        imageSrc = editor.ToolstripBackgroundImageCustomPath + "/" + sectionType.ToString() + ".bmp";
                        break;
                    default:
                        string resource = "Winthusiasm.HtmlEditor.Images.Toolstrips." + editor.ToolstripBackgroundImage.ToString() + "." + sectionType.ToString() + ".bmp";
                        imageSrc = editor.GetEncodedWebResourceUrl(resource);
                        break;
                }

                if (designerImplementation)
                {
                    HtmlImage img = new HtmlImage();
                    img.Src = imageSrc;
                    img.Style["height"] = editor.ToolbarHeight.ToString() + "px";
                    img.Style["width"] = "2px";
                    img.Style["vertical-align"] = "top";

                    toolstripSection.Controls.Add(img);
                }
                else
                {
                    toolstripSection.Style["background-image"] = "url(" + imageSrc + ")";
                    toolstripSection.Style["background-position"] = "left top";
                    toolstripSection.Style["background-repeat"] = sectionType == SectionType.Body ? "repeat-x" : "no-repeat";
                }
            }
        }

        /// <summary>
        /// The Toolbar class
        /// </summary>        
        public class Toolbar : HtmlGenericControl
        {
            /// <summary>
            /// Initializes a new instance of the <see cref="Toolbar" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>            
            public Toolbar(HtmlEditor editor)
                : base("div")
            {
                if (editor.ToolbarDocked)
{
                    this.Style["width"] = editor.Width.ToString();
}

                this.Style["height"] = editor.ToolbarHeight.ToString() + "px";
                this.Style["background-color"] = editor.ToToolbarColor;
            }
        }

        /// <summary>
        /// The ToolbarControlList class
        /// </summary>        
        public class ToolbarControlList : Dictionary<string, Control>
        {
        }

        #endregion

        #region CreateToolbarInfo EventHandler Classes

        /// <summary>
        /// The CreateToolbarInfoEventArgs class
        /// </summary>        
        public sealed class CreateToolbarInfoEventArgs : EventArgs
        {
            /// <summary>
            /// The editor field
            /// </summary>            
            private HtmlEditor editor;
            
            /// <summary>
            /// The toolbarInfoList field
            /// </summary>            
            private List<ToolbarInfo> toolbarInfoList;

            /// <summary>
            /// Initializes a new instance of the <see cref="CreateToolbarInfoEventArgs" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="toolbarInfoList">The toolbarInfoList parameter</param>            
            public CreateToolbarInfoEventArgs(HtmlEditor editor, List<ToolbarInfo> toolbarInfoList)
            {
                this.editor = editor;
                this.toolbarInfoList = toolbarInfoList;
            }

            /// <summary>
            /// Gets the ToolbarInfoList property
            /// </summary>            
            public List<ToolbarInfo> ToolbarInfoList
            {
                get { return this.toolbarInfoList; }
            }

            /// <summary>
            /// The SetButtons method
            /// </summary>
            /// <param name="buttonList">The buttonList parameter</param>
            /// <param name="commaDelimitedButtonNames">The commaDelimitedButtonNames parameter</param>            
            public void SetButtons(List<ButtonInfo> buttonList, string commaDelimitedButtonNames)
            {
                this.SetButtons(buttonList, this.editor.GetStringList(commaDelimitedButtonNames));
            }

            /// <summary>
            /// The AddButton method
            /// </summary>
            /// <param name="buttonList">The buttonList parameter</param>
            /// <param name="buttonInfo">The buttonInfo parameter</param>            
            public void AddButton(List<ButtonInfo> buttonList, ButtonInfo buttonInfo)
            {
                buttonList.Add(buttonInfo);
            }

            /// <summary>
            /// The FindButtonInfo method
            /// </summary>
            /// <param name="buttonList">The buttonList parameter</param>
            /// <param name="name">The name parameter</param>
            /// <returns>Button type object</returns>            
            private ButtonInfo FindButtonInfo(List<ButtonInfo> buttonList, string name)
            {
                foreach (ButtonInfo buttonInfo in buttonList)
                {
                    if (buttonInfo.Name == name)
                    {
                        return buttonInfo;
                    }
                }

                return null;
            }

            /// <summary>
            /// The SetButtons method
            /// </summary>
            /// <param name="buttonList">The buttonList parameter</param>
            /// <param name="names">The names parameter</param>            
            private void SetButtons(List<ButtonInfo> buttonList, string[] names)
            {
                List<ButtonInfo> newList = new List<ButtonInfo>();

                foreach (string name in names)
                {
                    ButtonInfo buttonInfo = this.FindButtonInfo(buttonList, name);
                    if (buttonInfo == null)
{
                        throw new HttpException(string.Format("No button named '{0}' was found in the button list", name));
}

                    newList.Add(buttonInfo);
                }

                buttonList.Clear();
                buttonList.AddRange(newList);
            }
        }

        #endregion

        #region DialogInfo Classes

        /// <summary>
        /// The DialogInfo class
        /// </summary>        
        public class DialogInfo
        {
            /// <summary>
            /// The name field
            /// </summary>            
            private string name;
            
            /// <summary>
            /// The frameUrl field
            /// </summary>            
            private string frameUrl;
            
            /// <summary>
            /// The heading field
            /// </summary>            
            private string heading;
            
            /// <summary>
            /// The height field
            /// </summary>            
            private int height;
            
            /// <summary>
            /// The width field
            /// </summary>            
            private int width;

            /// <summary>
            /// Initializes a new instance of the <see cref="DialogInfo" /> class.
            /// </summary>
            /// <param name="name">The name parameter</param>
            /// <param name="frameUrl">The frameUrl parameter</param>
            /// <param name="heading">The heading parameter</param>
            /// <param name="height">The height parameter</param>
            /// <param name="width">The width parameter</param>            
            public DialogInfo(string name, string frameUrl, string heading, int height, int width)
            {
                if (heading.IndexOf(",") >= 0)
{
                    throw new HttpException(string.Format("Dialog Dialog heading cannot contain a comma (Name = {0})", name));
}
                
                this.name = name;
                this.frameUrl = frameUrl;
                this.heading = heading;
                this.height = height;
                this.width = width;
            }

            /// <summary>
            /// Gets the Name property
            /// </summary>            
            public string Name
            {
                get { return this.name; }
            }

            /// <summary>
            /// Gets the FrameUrl property
            /// </summary>            
            public string FrameUrl
            {
                get { return this.frameUrl; }
            }

            /// <summary>
            /// Gets the Heading property
            /// </summary>            
            public string Heading
            {
                get { return this.heading; }
            }

            /// <summary>
            /// Gets the Height property
            /// </summary>            
            public int Height
            {
                get { return this.height; }
            }

            /// <summary>
            /// Gets the Width property
            /// </summary>            
            public int Width
            {
                get { return this.width; }
            }

            /// <summary>
            /// The GetDialogData method
            /// </summary>
            /// <returns>The string type object</returns>            
            public string GetDialogData()
            {
                string dialogData = string.Empty;

                dialogData += this.name;
                dialogData += "," + this.frameUrl;
                dialogData += "," + this.heading;
                dialogData += "," + this.height.ToString();
                dialogData += "," + this.width.ToString();

                return dialogData;
            }
        }

        #endregion

        #region CreateDialogInfo EventHandler Classes

        /// <summary>
        /// The CreateDialogInfoEventArgs class
        /// </summary>        
        public sealed class CreateDialogInfoEventArgs : EventArgs
        {
            /// <summary>
            /// The editor field
            /// </summary>            
            private HtmlEditor editor;
            
            /// <summary>
            /// The dialogs field
            /// </summary>            
            private List<DialogInfo> dialogs;

            /// <summary>
            /// Initializes a new instance of the <see cref="CreateDialogInfoEventArgs" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="dialogs">The dialogs parameter</param>            
            public CreateDialogInfoEventArgs(HtmlEditor editor, List<DialogInfo> dialogs)
            {
                this.editor = editor;
                this.dialogs = dialogs;
            }

            /// <summary>
            /// Gets the Dialogs property
            /// </summary>            
            public List<DialogInfo> Dialogs
            {
                get { return this.dialogs; }
            }
        }        

        #endregion        

        #region SaveButtonInfo Classes

        /// <summary>
        /// The SaveButtonInfo class
        /// </summary>        
        public class SaveButtonInfo
        {
            /// <summary>
            /// The editor field
            /// </summary>            
            private HtmlEditor editor;
            
            /// <summary>
            /// The pathElements field
            /// </summary>            
            private string[] pathElements;
            
            /// <summary>
            /// The absolute field
            /// </summary>            
            private bool absolute;

            /// <summary>
            /// Initializes a new instance of the <see cref="SaveButtonInfo" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="controlPath">The controlPath parameter</param>            
            public SaveButtonInfo(HtmlEditor editor, string controlPath)
            {
                this.editor = editor;
                this.pathElements = controlPath.Split('/');
                this.absolute = this.pathElements.Length > 1 && this.pathElements[0] == "~";
            }

            /// <summary>
            /// Gets the ControlPath property
            /// </summary>            
            public string ControlPath
            {
                get
                {
                    string controlPath = string.Empty;

                    foreach (string pathElement in this.pathElements)
                    {
                        if (controlPath.Length > 0)
                        {
                            controlPath += "/";
                        }

                        controlPath += pathElement;
                    }

                    return controlPath;
                }
            }
            
            /// <summary>
            /// The AttachButtons method
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="controlPaths">The controlPaths parameter</param>            
            public static void AttachButtons(HtmlEditor editor, string[] controlPaths)
            {
                SaveButtonInfoList buttons = new SaveButtonInfoList(editor, controlPaths);
                buttons.Attach();
            }

            /// <summary>
            /// The AttachButton method
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="control">The control parameter</param>            
            public static void AttachButton(HtmlEditor editor, Control control)
            {
                SaveButtonInfo.AttachClientSave(editor, control);
            }
            
            /// <summary>
            /// The Attach method
            /// </summary>
            /// <returns>type object</returns>            
            public bool Attach()
            {
                Control control = this.FindControl();
                if (control == null)
                {
                    return false;
                }

                AttachClientSave(this.editor, control);

                return true;
            }

            /// <summary>
            /// The GetModifiedOnClientClick method
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="onclientClick">The on client Click parameter</param>
            /// <returns>The string type object</returns>            
            protected static string GetModifiedOnClientClick(HtmlEditor editor, string onclientClick)
            {
                string editorSave = editor.FindScriptObject + ".Save()";
                if (onclientClick.Length == 0)
                {
                    return editorSave;
                }

                if (onclientClick.IndexOf(editorSave) >= 0)
                {
                    return onclientClick;
                }

                return editorSave + "; " + onclientClick;
            }

            /// <summary>
            /// The AttachClientSave method
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="control">The control parameter</param>            
            protected static void AttachClientSave(HtmlEditor editor, Control control)
            {
                if (control is Button)
                {
                    Button b = (Button)control;
                    b.OnClientClick = GetModifiedOnClientClick(editor, b.OnClientClick);
                }
                else if (control is LinkButton)
                {
                    LinkButton lb = (LinkButton)control;
                    lb.OnClientClick = GetModifiedOnClientClick(editor, lb.OnClientClick);
                }
                else if (control is ImageButton)
                {
                    ImageButton ib = (ImageButton)control;
                    ib.OnClientClick = GetModifiedOnClientClick(editor, ib.OnClientClick);
                }
                else
                {
                    throw new HttpException(string.Format("Invalid SaveButton control type: {0}", control.ID));
                }
            }

            /// <summary>
            /// The FindNearest method
            /// </summary>
            /// <param name="controlID">The controlID parameter</param>
            /// <returns>The System.Web.UI.Control type object</returns>            
            protected Control FindNearest(string controlID)
            {
                Control container = this.editor.NamingContainer;

                while (container != null)
                {
                    Control control = container.FindControl(controlID);
                    if (control != null)
                    {
                        return control;
                    }

                    container = container.NamingContainer;
                }

                return null;
            }

            /// <summary>
            /// The FindExact method
            /// </summary>
            /// <param name="container">The container parameter</param>
            /// <param name="index">The index parameter</param>
            /// <returns>The System.Web.UI.Control type object</returns>            
            protected Control FindExact(Control container, int index)
            {
                Control control = null;

                for (int i = index; i < this.pathElements.Length; i++)
                {
                    control = container.FindControl(this.pathElements[i]);
                    if (control == null)
                    {
                        return null;
                    }

                    container = control;
                }

                return control;
            }

            /// <summary>
            /// The FindStartContainer method
            /// </summary>
            /// <param name="index">The index parameter</param>
            /// <returns>The System.Web.UI.Control type object</returns>            
            protected Control FindStartContainer(out int index)
            {
                index = 0;
                Control container = this.editor.NamingContainer;

                for (int i = 0; i < this.pathElements.Length - 1; i++)
                {
                    if (this.pathElements[i] == "..")
                    {
                        index = i + 1;

                        container = container.NamingContainer;
                        if (container == null)
                        {
                            return null;
                        }
                    }
                    else
                    {
                        index = i;
                        break;
                    }
                }

                return container;
            }

            /// <summary>
            /// The FindControl method
            /// </summary>
            /// <returns>The System.Web.UI.Control type object</returns>            
            protected Control FindControl()
            {
                if (this.pathElements.Length == 1)
                {
                    return this.FindNearest(this.pathElements[0]);
                }
                else if (this.absolute)
                {
                    this.FindExact(this.editor.Page, 1);
                }
                else
                {
                    int index;
                    Control container = this.FindStartContainer(out index);
                    if (container == null)
                    {
                        return null;
                    }

                    return this.FindExact(container, index);
                }

                return null;
            }
        }

        /// <summary>
        /// The SaveButtonInfoList class
        /// </summary>        
        public class SaveButtonInfoList
        {
            /// <summary>
            /// The buttons field
            /// </summary>            
            private List<SaveButtonInfo> buttons;

            /// <summary>
            /// Initializes a new instance of the <see cref="SaveButtonInfoList" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="controlPaths">The controlPaths parameter</param>            
            public SaveButtonInfoList(HtmlEditor editor, string[] controlPaths)
            {
                this.buttons = new List<SaveButtonInfo>();

                foreach (string controlPath in controlPaths)
                {
                    this.buttons.Add(new SaveButtonInfo(editor, controlPath));
                }
            }

            /// <summary>
            /// The Attach method
            /// </summary>            
            public void Attach()
            {
                foreach (SaveButtonInfo button in this.buttons)
                {
                    if (!button.Attach())
                    {
                        throw new HttpException(string.Format("Invalid SaveButton control path: {0}", button.ControlPath));
                    }
                }
            }
        }

        #endregion

        #region VisualStudio Class

        /// <summary>
        /// The VisualStudio class
        /// </summary>        
        public class VisualStudio
        {
            /// <summary>
            /// Gets the Version property
            /// </summary>            
            public static string Version
            {
                get
                {
#if ASPNET3_5
                    return "2008";
#else
                    return "2005";
#endif
                }
            }
        }

        #endregion

        #region ColorSchemeInfo Classes

        /// <summary>
        /// The ColorSchemeInfo class
        /// </summary>        
        public class ColorSchemeInfo
        {
            /// <summary>
            /// The editor field
            /// </summary>            
            private HtmlEditor editor;

            /// <summary>
            /// The name field
            /// </summary>            
            private string name;

            /// <summary>
            /// Initializes a new instance of the <see cref="ColorSchemeInfo" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="name">The name parameter</param>            
            public ColorSchemeInfo(HtmlEditor editor, string name)
            {
                this.editor = editor;
                this.name = name;
            }

            /// <summary>
            /// Gets or sets EditorBorderColor field
            /// </summary>            
            public Color EditorBorderColor
            {
                get
                {
                    return this.EditorBorderColor;
                }

                set
                {
                    this.EditorBorderColor = ColorTranslator.FromHtml("#7f9db9");
                }
            }

            /// <summary>
            /// Gets or sets EditorInnerBorderColor field
            /// </summary>            
            public Color EditorInnerBorderColor
            {
                get
                {
                    return this.EditorInnerBorderColor;
                }

                set
                {
                    this.EditorInnerBorderColor = ColorTranslator.FromHtml("Gray");
                }
            }

            /// <summary>
            /// Gets or sets ToolbarColor field
            /// </summary>            
            public Color ToolbarColor
            {
                get
                {
                    return this.ToolbarColor;
                }

                set
                {
                    this.ToolbarColor = ColorTranslator.FromHtml("#7f9db9");
                }
            }

            /// <summary>
            /// Gets or sets TabForeColor field
            /// </summary>            
            public Color TabForeColor
            {
                get
                {
                    return this.TabForeColor;
                }

                set
                {
                    this.TabForeColor = ColorTranslator.FromHtml("Black");
                }
            }

            /// <summary>
            /// Gets or sets TabBackColor field
            /// </summary>            
            public Color TabBackColor
            {
                get
                {
                    return this.TabBackColor;
                }

                set
                {
                    this.TabBackColor = ColorTranslator.FromHtml("LightSteelBlue");
                }
            }

            /// <summary>
            /// Gets or sets SelectedTabBackColor field
            /// </summary>            
            public Color SelectedTabBackColor
            {
                get
                {
                    return this.SelectedTabBackColor;
                }

                set
                {
                    this.SelectedTabBackColor = ColorTranslator.FromHtml("#7f9db9");
                }
            }

            /// <summary>
            /// Gets or sets SelectedTabTextColor field
            /// </summary>            
            public Color SelectedTabTextColor
            {
                get
                {
                    return this.SelectedTabTextColor;
                }

                set
                {
                    this.SelectedTabTextColor = ColorTranslator.FromHtml("White");
                }
            }

            /// <summary>
            /// Gets or sets Tab Mouse Over Color field
            /// </summary>            
            public Color TabMouseOverColor
            {
                get
                {
                    return this.TabMouseOverColor;
                }

                set
                {
                    this.TabMouseOverColor = ColorTranslator.FromHtml("LightBlue");
                }
            }

            /// <summary>
            /// Gets or sets Tab bar BackColor field
            /// </summary>            
            public Color TabbarBackColor
            {
                get
                {
                    return this.TabbarBackColor;
                }

                set
                {
                    this.TabbarBackColor = ColorTranslator.FromHtml("White");
                }
            }

            /// <summary>
            /// Gets or sets Button Mouse Over Color field
            /// </summary>            
            public Color ButtonMouseOverColor
            {
                get
                {
                    return this.ButtonMouseOverColor;
                }

                set
                {
                    this.ButtonMouseOverColor = ColorTranslator.FromHtml("#c1d2ee");
                }
            }

            /// <summary>
            /// Gets or sets Button Mouse Over Border Color field
            /// </summary>            
            public Color ButtonMouseOverBorderColor
            {
                get
                {
                    return this.ButtonMouseOverBorderColor;
                }

                set
                {
                    this.ButtonMouseOverBorderColor = ColorTranslator.FromHtml("#316ac5");
                }
            }

            /// <summary>
            /// Gets or sets Dialog Back Color field
            /// </summary>            
            public Color DialogBackColor
            {
                get
                {
                    return this.DialogBackColor;
                }

                set
                {
                    this.DialogBackColor = ColorTranslator.FromHtml("GhostWhite");
                }
            }

            /// <summary>
            /// Gets or sets Dialog Fore Color field
            /// </summary>            
            public Color DialogForeColor
            {
                get
                {
                    return this.DialogForeColor;
                }

                set
                {
                    this.DialogForeColor = ColorTranslator.FromHtml("Black");
                }
            }

            /// <summary>
            /// Gets or sets Dialog Heading Color field
            /// </summary>            
            public Color DialogHeadingColor
            {
                get
                {
                    return this.DialogHeadingColor;
                }

                set
                {
                    this.DialogHeadingColor = ColorTranslator.FromHtml("LightSteelBlue");
                }
            }

            /// <summary>
            /// Gets or sets Dialog Heading Text Color field
            /// </summary>            
            public Color DialogHeadingTextColor
            {
                get
                {
                    return this.DialogHeadingTextColor;
                }

                set
                {
                    this.DialogHeadingTextColor = ColorTranslator.FromHtml("Black");
                }
            }

            /// <summary>
            /// Gets or sets Dialog Button Bar Color field
            /// </summary>            
            public Color DialogButtonBarColor
            {
                get
                {
                    return this.DialogButtonBarColor;
                }

                set
                {
                    this.DialogButtonBarColor = ColorTranslator.FromHtml("LightSteelBlue");
                }
            }

            /// <summary>
            /// Gets or sets Dialog Table Color field
            /// </summary>            
            public Color DialogTableColor
            {
                get
                {
                    return this.DialogTableColor;
                }

                set
                {
                    this.DialogTableColor = ColorTranslator.FromHtml("#eeeeee");
                }
            }

            /// <summary>
            /// Gets or sets DialogTabTextColor field
            /// </summary>            
            public Color DialogTabTextColor
            {
                get
                {
                    return this.DialogTabTextColor;
                }

                set
                {
                    this.DialogTabTextColor = ColorTranslator.FromHtml("Black");
                }
            }

            /// <summary>
            /// Gets or sets DialogSelectedTabTextColor field
            /// </summary>            
            public Color DialogSelectedTabTextColor
            {
                get
                {
                    return this.DialogSelectedTabTextColor;
                }

                set
                {
                    this.DialogSelectedTabTextColor = ColorTranslator.FromHtml("White");
                }
            }

            /// <summary>
            /// Gets or sets DialogUnselectedTabColor field
            /// </summary>            
            public Color DialogUnselectedTabColor
            {
                get
                {
                    return this.DialogUnselectedTabColor;
                }

                set
                {
                    this.DialogUnselectedTabColor = ColorTranslator.FromHtml("LightSteelBlue");
                }
            }

            /// <summary>
            /// Gets or sets DialogSelectedTabColor field
            /// </summary>            
            public Color DialogSelectedTabColor
            {
                get
                {
                    return this.DialogSelectedTabColor;
                }

                set
                {
                    this.DialogSelectedTabColor = ColorTranslator.FromHtml("#7f9db9");
                }
            }

            /// <summary>
            /// Gets the Name property
            /// </summary>            
            public string Name
            {
                get { return this.name; }
            }

            /// <summary>
            /// Gets or sets EditorBackColor field
            /// </summary>            
            public Color EditorBackColor
            {
                get
                {
                    return this.EditorBackColor;
                }

                set
                {
                    this.EditorBackColor = ColorTranslator.FromHtml("White");
                }
            }

            /// <summary>
            /// Gets or sets EditorForeColor field
            /// </summary>            
            public Color EditorForeColor
            {
                get
                {
                    return this.EditorForeColor;
                }

                set
                {
                    this.EditorForeColor = ColorTranslator.FromHtml("Black");
                }
            }

            /// <summary>
            /// Gets or sets BackColor field
            /// </summary>            
            public Color BackColor
            {
                get
                {
                    return this.BackColor;
                }

                set
                {
                    this.BackColor = ColorTranslator.FromHtml("White");
                }
            }

            /// <summary>
            /// Gets or sets Tool strip Background Image field
            /// </summary>            
            public ToolstripBackgroundImageType ToolstripBackgroundImage 
            {
                get
                {
                    return this.ToolstripBackgroundImage;
                }

                set
                {
                    this.ToolstripBackgroundImage = ToolstripBackgroundImageType.Default;
                }
            }

            /// <summary>
            /// Gets or sets DialogBorderColor field
            /// </summary>            
            public Color DialogBorderColor
            {
                get
                {
                    return this.DialogBorderColor;
                }

                set
                {
                    this.DialogBorderColor = ColorTranslator.FromHtml("Black");
                }
            }                

            /// <summary>
            /// The ReadColors method
            /// </summary>            
            public void ReadColors()
            {
                this.ToolstripBackgroundImage = this.editor.ToolstripBackgroundImage;

                this.BackColor = this.editor.BackColor;
                this.EditorForeColor = this.editor.EditorForeColor;
                this.EditorBackColor = this.editor.EditorBackColor;
                this.EditorBorderColor = this.editor.EditorBorderColor;
                this.EditorInnerBorderColor = this.editor.EditorInnerBorderColor;
                this.ToolbarColor = this.editor.ToolbarColor;
                this.TabForeColor = this.editor.TabForeColor;
                this.TabBackColor = this.editor.TabBackColor;
                this.SelectedTabBackColor = this.editor.SelectedTabBackColor;
                this.SelectedTabTextColor = this.editor.SelectedTabTextColor;
                this.TabMouseOverColor = this.editor.TabMouseOverColor;
                this.TabbarBackColor = this.editor.TabbarBackColor;
                this.ButtonMouseOverColor = this.editor.ButtonMouseOverColor;
                this.ButtonMouseOverBorderColor = this.editor.ButtonMouseOverBorderColor;
                this.DialogBackColor = this.editor.DialogBackColor;
                this.DialogForeColor = this.editor.DialogForeColor;
                this.DialogHeadingColor = this.editor.DialogHeadingColor;
                this.DialogHeadingTextColor = this.editor.DialogHeadingTextColor;
                this.DialogButtonBarColor = this.editor.DialogButtonBarColor;
                this.DialogTableColor = this.editor.DialogTableColor;
                this.DialogTabTextColor = this.editor.DialogTabTextColor;
                this.DialogSelectedTabTextColor = this.editor.DialogSelectedTabTextColor;
                this.DialogUnselectedTabColor = this.editor.DialogUnselectedTabColor;
                this.DialogSelectedTabColor = this.editor.DialogSelectedTabColor;
                this.DialogBorderColor = this.editor.DialogBorderColor;
            }

            /// <summary>
            /// The SetColors method
            /// </summary>            
            public void SetColors()
            {
                this.editor.ToolstripBackgroundImage = this.ToolstripBackgroundImage;

                this.editor.BackColor = this.BackColor;
                this.editor.EditorForeColor = this.EditorForeColor;
                this.editor.EditorBackColor = this.EditorBackColor;
                this.editor.EditorBorderColor = this.EditorBorderColor;
                this.editor.EditorInnerBorderColor = this.EditorInnerBorderColor;
                this.editor.ToolbarColor = this.ToolbarColor;
                this.editor.TabForeColor = this.TabForeColor;
                this.editor.TabBackColor = this.TabBackColor;
                this.editor.SelectedTabBackColor = this.SelectedTabBackColor;
                this.editor.SelectedTabTextColor = this.SelectedTabTextColor;
                this.editor.TabMouseOverColor = this.TabMouseOverColor;
                this.editor.TabbarBackColor = this.TabbarBackColor;
                this.editor.ButtonMouseOverColor = this.ButtonMouseOverColor;
                this.editor.ButtonMouseOverBorderColor = this.ButtonMouseOverBorderColor;
                this.editor.DialogBackColor = this.DialogBackColor;
                this.editor.DialogForeColor = this.DialogForeColor;
                this.editor.DialogHeadingColor = this.DialogHeadingColor;
                this.editor.DialogHeadingTextColor = this.DialogHeadingTextColor;
                this.editor.DialogButtonBarColor = this.DialogButtonBarColor;
                this.editor.DialogTableColor = this.DialogTableColor;
                this.editor.DialogTabTextColor = this.DialogTabTextColor;
                this.editor.DialogSelectedTabTextColor = this.DialogSelectedTabTextColor;
                this.editor.DialogUnselectedTabColor = this.DialogUnselectedTabColor;
                this.editor.DialogSelectedTabColor = this.DialogSelectedTabColor;
                this.editor.DialogBorderColor = this.DialogBorderColor;
            }

            /// <summary>
            /// The GetColor method
            /// </summary>
            /// <param name="htmlColor">The htmlColor parameter</param>
            /// <returns>The System.Drawing.Color type object</returns>            
            public Color GetColor(string htmlColor)
            {
                return ColorTranslator.FromHtml(htmlColor);
            }                       
        }

        /// <summary>
        /// The VisualStudioColorSchemeInfo class
        /// </summary>        
        public class VisualStudioColorSchemeInfo : ColorSchemeInfo
        {
            /// <summary>
            /// Initializes a new instance of the <see cref="VisualStudioColorSchemeInfo" /> class.
            /// </summary>
            /// <param name="editor">The editor parameter</param>
            /// <param name="name">The name parameter</param>            
            public VisualStudioColorSchemeInfo(HtmlEditor editor, string name)
                : base(editor, name)
            {
                this.ToolstripBackgroundImage = ToolstripBackgroundImageType.VisualStudio;

                this.EditorBorderColor = this.GetColor("#dedcbc");
                this.ToolbarColor = this.GetColor("#dedcbc");
                this.TabBackColor = this.GetColor("#cccc99");
                this.SelectedTabBackColor = this.GetColor("#dedcbc");
                this.SelectedTabTextColor = this.GetColor("Black");
                this.TabMouseOverColor = this.GetColor("#d8d5a7");
                this.DialogHeadingColor = this.GetColor("#dedcbc");
                this.DialogHeadingTextColor = this.GetColor("Black");
                this.DialogButtonBarColor = this.GetColor("#dedcbc");
                this.DialogTabTextColor = this.GetColor("Black");
                this.DialogSelectedTabTextColor = this.GetColor("Black");
                this.DialogUnselectedTabColor = this.GetColor("#cccc99");
                this.DialogSelectedTabColor = this.GetColor("#dedcbc");
            }
        }

        #endregion

        #region CreateColorSchemeInfo EventHandler Classes

        /// <summary>
        /// The CreateColorSchemeInfoEventArgs class
        /// </summary>        
        public sealed class CreateColorSchemeInfoEventArgs : EventArgs
        {
            /// <summary>
            /// The colorSchemeInfo field
            /// </summary>            
            private ColorSchemeInfo colorSchemeInfo;

            /// <summary>
            /// Initializes a new instance of the <see cref="CreateColorSchemeInfoEventArgs" /> class.
            /// </summary>
            /// <param name="colorSchemeInfo">The colorSchemeInfo parameter</param>            
            public CreateColorSchemeInfoEventArgs(ColorSchemeInfo colorSchemeInfo)
            {
                this.colorSchemeInfo = colorSchemeInfo;
            }

            /// <summary>
            /// Gets the ColorScheme property
            /// </summary>            
            public ColorSchemeInfo ColorScheme
            {
                get { return this.colorSchemeInfo; }
            }            
        }

        #endregion
    }
}
